2021-03-11T12:16:35.462638900Z Traceback (most recent call last):
2021-03-11T12:16:35.462678500Z   File "/tmp/entrypoint.py", line 91, in <module>
2021-03-11T12:16:35.462683200Z     main()
2021-03-11T12:16:35.462685600Z   File "/tmp/entrypoint.py", line 87, in main
2021-03-11T12:16:35.462687900Z     run_model(options.script, *options.args)
2021-03-11T12:16:35.462690100Z   File "/tmp/entrypoint.py", line 42, in run_model
2021-03-11T12:16:35.462692400Z     return check_output(log_file)
2021-03-11T12:16:35.462694600Z   File "/tmp/entrypoint.py", line 57, in check_output
2021-03-11T12:16:35.462696900Z     raise RuntimeError(f"Problem found running stata script:\n\n{output}")
2021-03-11T12:16:35.462700000Z RuntimeError: Problem found running stata script:
2021-03-11T12:16:35.462702300Z 
2021-03-11T12:16:35.462704500Z 
2021-03-11T12:16:35.462706600Z   ___  ____  ____  ____  ____ (R)
2021-03-11T12:16:35.462708800Z  /__    /   ____/   /   ____/
2021-03-11T12:16:35.462711000Z ___/   /   /___/   /   /___/   16.1   Copyright 1985-2019 StataCorp LLC
2021-03-11T12:16:35.462713300Z   Statistics/Data Analysis            StataCorp
2021-03-11T12:16:35.462715500Z                                       4905 Lakeway Drive
2021-03-11T12:16:35.462717700Z      MP - Parallel Edition            College Station, Texas 77845 USA
2021-03-11T12:16:35.462720000Z                                       800-STATA-PC        http://www.stata.com
2021-03-11T12:16:35.462722300Z                                       979-696-4600        stata@stata.com
2021-03-11T12:16:35.462724600Z                                       979-696-4601 (fax)
2021-03-11T12:16:35.462726800Z 
2021-03-11T12:16:35.462728900Z 3-user 32-core Stata network license expires 29 Apr 2021:
2021-03-11T12:16:35.462731200Z        Serial number:  501609309502
2021-03-11T12:16:35.462733400Z          Licensed to:  EBM DataLab
2021-03-11T12:16:35.462735500Z                        University of Oxford
2021-03-11T12:16:35.462737800Z 
2021-03-11T12:16:35.462739900Z Notes:
2021-03-11T12:16:35.462742400Z       1.  Stata is running in batch mode.
2021-03-11T12:16:35.462744700Z Some Unicode string functions will not behave correctly because ICU data file
2021-03-11T12:16:35.462747000Z     icudt54l.dat cannot be found at directory: "/usr/local/stata/utilities"
2021-03-11T12:16:35.462749400Z       2.  Unicode is supported; see help unicode_advice.
2021-03-11T12:16:35.462751700Z       3.  More than 2 billion observations are allowed; see help obs_advice.
2021-03-11T12:16:35.462753900Z       4.  Maximum number of variables is set to 5000; see help set_maxvar.
2021-03-11T12:16:35.462756200Z 
2021-03-11T12:16:35.462758500Z . do analysis/STATA_code.do 
2021-03-11T12:16:35.462760600Z 
2021-03-11T12:16:35.462767100Z . /*===========================================================================
2021-03-11T12:16:35.462769800Z > ===
2021-03-11T12:16:35.462772100Z > DO FILE NAME:                   create_analysis_dataset
2021-03-11T12:16:35.462774400Z > PROJECT:                                Immunosuppressant meds research
2021-03-11T12:16:35.462776700Z > DATE:                                   2nd Feb 2021
2021-03-11T12:16:35.462779000Z > AUTHOR:                                 M Yates
2021-03-11T12:16:35.462781200Z >                                                 adapted from C Rentsch       
2021-03-11T12:16:35.462784300Z >                                                                    
2021-03-11T12:16:35.462786600Z > DESCRIPTION OF FILE:    data management for immunosuppressant meds project  
2021-03-11T12:16:35.462789000Z >                                                 reformat variables 
2021-03-11T12:16:35.462791200Z >                                                 categorise variables
2021-03-11T12:16:35.462793500Z >                                                 label variables 
2021-03-11T12:16:35.462795800Z > DATASETS USED:                  data in memory (from output/input.csv)
2021-03-11T12:16:35.462798100Z > DATASETS CREATED:               none
2021-03-11T12:16:35.462800300Z > OTHER OUTPUT:                   logfiles, printed to folder $Logdir
2021-03-11T12:16:35.462802600Z > USER-INSTALLED ADO:      
2021-03-11T12:16:35.462804800Z >   (place .ado file(s) in analysis folder)                                    
2021-03-11T12:16:35.462831100Z >            
2021-03-11T12:16:35.462833500Z > =============================================================================
2021-03-11T12:16:35.462836000Z > =*/
2021-03-11T12:16:35.462838300Z . 
2021-03-11T12:16:35.462840400Z . import delimited `c(pwd)'/output/input.csv, clear
2021-03-11T12:16:35.462842700Z (115 vars, 50,000 obs)
2021-03-11T12:16:35.462844900Z 
2021-03-11T12:16:35.462847000Z . 
2021-03-11T12:16:35.462849100Z . * set filepaths
2021-03-11T12:16:35.462851300Z . 
2021-03-11T12:16:35.462853400Z . global projectdir `c(pwd)'
2021-03-11T12:16:35.462855600Z 
2021-03-11T12:16:35.462857700Z . di "$projectdir"
2021-03-11T12:16:35.462859900Z /workspace
2021-03-11T12:16:35.462862100Z 
2021-03-11T12:16:35.462864200Z . 
2021-03-11T12:16:35.462866300Z . global logdir "$projectdir/logs"
2021-03-11T12:16:35.462868600Z 
2021-03-11T12:16:35.462870700Z . di "$logdir"
2021-03-11T12:16:35.462872900Z /workspace/logs
2021-03-11T12:16:35.462875700Z 
2021-03-11T12:16:35.462878900Z . 
2021-03-11T12:16:35.462885600Z . * Open a log file
2021-03-11T12:16:35.462889500Z . cap log close
2021-03-11T12:16:35.462892900Z 
2021-03-11T12:16:35.462896300Z . log using "$logdir/cr_create_analysis_dataset", replace
2021-03-11T12:16:35.462899700Z (note: file /workspace/logs/cr_create_analysis_dataset.smcl not found)
2021-03-11T12:16:35.462903200Z -------------------------------------------------------------------------------
2021-03-11T12:16:35.462906600Z       name:  <unnamed>
2021-03-11T12:16:35.462909900Z        log:  /workspace/logs/cr_create_analysis_dataset.smcl
2021-03-11T12:16:35.462912900Z   log type:  smcl
2021-03-11T12:16:35.462915900Z  opened on:  11 Mar 2021, 12:16:32
2021-03-11T12:16:35.462918900Z 
2021-03-11T12:16:35.462921700Z . 
2021-03-11T12:16:35.462924500Z . * Set Ado file path
2021-03-11T12:16:35.462928000Z . adopath + "$projectdir/analysis/extra_ados"
2021-03-11T12:16:35.462932400Z   [1]  (BASE)      "/usr/local/stata/ado/base/"
2021-03-11T12:16:35.462935000Z   [2]  (SITE)      "/usr/local/ado/"
2021-03-11T12:16:35.462937400Z   [3]              "."
2021-03-11T12:16:35.462939700Z   [4]  (PERSONAL)  "~/ado/personal/"
2021-03-11T12:16:35.462941900Z   [5]  (PLUS)      "~/ado/plus/"
2021-03-11T12:16:35.462944200Z   [6]  (OLDPLACE)  "~/ado/"
2021-03-11T12:16:35.462946400Z   [7]              "/workspace/analysis/extra_ados"
2021-03-11T12:16:35.462948800Z 
2021-03-11T12:16:35.462950900Z . 
2021-03-11T12:16:35.462953000Z . /* SET Index date ===========================================================
2021-03-11T12:16:35.462955300Z > */
2021-03-11T12:16:35.462957500Z . global indexdate                        = "01/03/2020"
2021-03-11T12:16:35.462959800Z 
2021-03-11T12:16:35.462962000Z . 
2021-03-11T12:16:35.462964100Z . /* RENAME VARIABLES==========================================================
2021-03-11T12:16:35.462966400Z > =*/
2021-03-11T12:16:35.462968600Z . 
2021-03-11T12:16:35.462970700Z . rename inflammatory_bowel_disease_uncla ibd_uncla
2021-03-11T12:16:35.462972900Z 
2021-03-11T12:16:35.462975000Z . 
2021-03-11T12:16:35.462977200Z . /* Drop variables not needed ================================================
2021-03-11T12:16:35.462979500Z > */
2021-03-11T12:16:35.462982200Z . *calculating ckd from creat 
2021-03-11T12:16:35.462984500Z . drop ckd ethnicity_date mepolizumab_3m_0m mepolizumab_6m_3m vedolizumab_3m_0m
2021-03-11T12:16:35.462986800Z >  vedolizumab_6m_3m
2021-03-11T12:16:35.462988900Z 
2021-03-11T12:16:35.462991000Z . 
2021-03-11T12:16:35.462996400Z . /* CONVERT STRINGS TO DATE===================================================
2021-03-11T12:16:35.462998900Z > =*/
2021-03-11T12:16:35.463001100Z . /* Comorb dates are given with month/year only, so adding day 15 to enable
2021-03-11T12:16:35.463003400Z >    them to be processed as dates */
2021-03-11T12:16:35.463005700Z . 
2021-03-11T12:16:35.463007800Z . foreach var of varlist   crohns_disease                                      
2021-03-11T12:16:35.463010000Z >    ///
2021-03-11T12:16:35.463012300Z >                                                  ulcerative_colitis          
2021-03-11T12:16:35.463014600Z >                            ///
2021-03-11T12:16:35.463016900Z >                                                  ibd_uncla                   
2021-03-11T12:16:35.463019200Z >            ///
2021-03-11T12:16:35.463021300Z >                                                  atopic_dermatitis           
2021-03-11T12:16:35.463023600Z >                            ///
2021-03-11T12:16:35.463025900Z >                                                  psoriasis                   
2021-03-11T12:16:35.463028200Z >                                    ///
2021-03-11T12:16:35.463030400Z >                                                  hidradenitis_suppurativa    
2021-03-11T12:16:35.463032700Z >                    ///
2021-03-11T12:16:35.463034900Z >                                                  psoriatic_arthritis         
2021-03-11T12:16:35.463037200Z >                    ///
2021-03-11T12:16:35.463039400Z >                                                  rheumatoid_arthritis        
2021-03-11T12:16:35.463041700Z >                    ///
2021-03-11T12:16:35.463043800Z >                                                  ankylosing_spondylitis      
2021-03-11T12:16:35.463046200Z >                    ///
2021-03-11T12:16:35.463048400Z >                                                  chronic_cardiac_disease     
2021-03-11T12:16:35.463050700Z >                    ///
2021-03-11T12:16:35.463052800Z >                                                  hba1c_new                   
2021-03-11T12:16:35.463055100Z >                                    ///
2021-03-11T12:16:35.463057300Z >                                                  hba1c_old                   
2021-03-11T12:16:35.463059600Z >                                    ///
2021-03-11T12:16:35.463061800Z >                                                  hba1c_mmol_per_mol_date     
2021-03-11T12:16:35.463064100Z >                    ///
2021-03-11T12:16:35.463066400Z >                                                  hba1c_percentage_date       
2021-03-11T12:16:35.463068700Z >                    ///
2021-03-11T12:16:35.463073400Z >                                                  diabetes                    
2021-03-11T12:16:35.463076000Z >                                    ///
2021-03-11T12:16:35.463078300Z >                                                  hypertension                
2021-03-11T12:16:35.463083500Z >                            ///
2021-03-11T12:16:35.463085700Z >                                                  chronic_respiratory_disease 
2021-03-11T12:16:35.463088000Z >            ///
2021-03-11T12:16:35.463090200Z >                                                  esrf                        
2021-03-11T12:16:35.463095900Z >                                    ///
2021-03-11T12:16:35.463098200Z >                                                  copd                        
2021-03-11T12:16:35.463100500Z >                                    ///
2021-03-11T12:16:35.463102700Z >                                                  chronic_liver_disease       
2021-03-11T12:16:35.463105000Z >                    ///
2021-03-11T12:16:35.463107200Z >                                                  stroke                      
2021-03-11T12:16:35.463109500Z >                                    ///
2021-03-11T12:16:35.463111700Z >                                                  lung_cancer                 
2021-03-11T12:16:35.463114100Z >                            ///
2021-03-11T12:16:35.463116400Z >                                                  haem_cancer                 
2021-03-11T12:16:35.463118600Z >                            ///
2021-03-11T12:16:35.463120900Z >                                                  other_cancer                
2021-03-11T12:16:35.463123200Z >                            ///
2021-03-11T12:16:35.463125400Z >                                                  creatinine_date             
2021-03-11T12:16:35.463127700Z >                    ///
2021-03-11T12:16:35.463129900Z >                                                  organ_transplant            
2021-03-11T12:16:35.463132200Z >                            ///
2021-03-11T12:16:35.463134400Z >                                                  bmi_date_measured           
2021-03-11T12:16:35.463136800Z >                    {
2021-03-11T12:16:35.463139400Z   2.                                                         
2021-03-11T12:16:35.463141800Z .                 capture confirm string variable `var'
2021-03-11T12:16:35.463144100Z   3.                 if _rc!=0 {
2021-03-11T12:16:35.463146500Z   4.                         assert `var'==.
2021-03-11T12:16:35.463148900Z   5.                         rename `var' `var'_date
2021-03-11T12:16:35.463151200Z   6.                 }
2021-03-11T12:16:35.463153700Z   7.         
2021-03-11T12:16:35.463158300Z .                 else {
2021-03-11T12:16:35.463160800Z   8.                                 replace `var' = `var' + "-15"
2021-03-11T12:16:35.463163200Z   9.                                 rename `var' `var'_dstr
2021-03-11T12:16:35.463165400Z  10.                                 replace `var'_dstr = " " if `var'_dstr == 
2021-03-11T12:16:35.463167900Z > "-15"
2021-03-11T12:16:35.463170200Z  11.                                 gen `var'_date = date(`var'_dstr, "YMD") 
2021-03-11T12:16:35.463173000Z  12.                                 order `var'_date, after(`var'_dstr)
2021-03-11T12:16:35.463175300Z  13.                                 drop `var'_dstr
2021-03-11T12:16:35.463177600Z  14.                 }
2021-03-11T12:16:35.463179800Z  15.         
2021-03-11T12:16:35.463181900Z .         format `var'_date %td
2021-03-11T12:16:35.463184400Z  16. }
2021-03-11T12:16:35.463187000Z variable crohns_disease was str7 now str10
2021-03-11T12:16:35.463189600Z (50,000 real changes made)
2021-03-11T12:16:35.463191700Z (40,000 real changes made)
2021-03-11T12:16:35.463193900Z (40,000 missing values generated)
2021-03-11T12:16:35.463196100Z variable ulcerative_colitis was str7 now str10
2021-03-11T12:16:35.463198400Z (50,000 real changes made)
2021-03-11T12:16:35.463200500Z (40,000 real changes made)
2021-03-11T12:16:35.463202700Z (40,000 missing values generated)
2021-03-11T12:16:35.463204900Z variable ibd_uncla was str7 now str10
2021-03-11T12:16:35.463207100Z (50,000 real changes made)
2021-03-11T12:16:35.463209300Z (40,000 real changes made)
2021-03-11T12:16:35.463211400Z (40,000 missing values generated)
2021-03-11T12:16:35.463213600Z variable atopic_dermatitis was str7 now str10
2021-03-11T12:16:35.463215900Z (50,000 real changes made)
2021-03-11T12:16:35.463218200Z (40,000 real changes made)
2021-03-11T12:16:35.463220400Z (40,000 missing values generated)
2021-03-11T12:16:35.463222600Z variable psoriasis was str7 now str10
2021-03-11T12:16:35.463224900Z (50,000 real changes made)
2021-03-11T12:16:35.463227100Z (40,000 real changes made)
2021-03-11T12:16:35.463229300Z (40,000 missing values generated)
2021-03-11T12:16:35.463231500Z variable hidradenitis_suppurativa was str7 now str10
2021-03-11T12:16:35.463233800Z (50,000 real changes made)
2021-03-11T12:16:35.463236100Z (40,000 real changes made)
2021-03-11T12:16:35.463238200Z (40,000 missing values generated)
2021-03-11T12:16:35.463240400Z variable psoriatic_arthritis was str7 now str10
2021-03-11T12:16:35.463242700Z (50,000 real changes made)
2021-03-11T12:16:35.463244900Z (40,000 real changes made)
2021-03-11T12:16:35.463249900Z (40,000 missing values generated)
2021-03-11T12:16:35.463252600Z variable rheumatoid_arthritis was str7 now str10
2021-03-11T12:16:35.463255000Z (50,000 real changes made)
2021-03-11T12:16:35.463257200Z (40,000 real changes made)
2021-03-11T12:16:35.463259300Z (40,000 missing values generated)
2021-03-11T12:16:35.463261600Z variable ankylosing_spondylitis was str7 now str10
2021-03-11T12:16:35.463264000Z (50,000 real changes made)
2021-03-11T12:16:35.463266200Z (40,000 real changes made)
2021-03-11T12:16:35.463268700Z (40,000 missing values generated)
2021-03-11T12:16:35.463270900Z variable chronic_cardiac_disease was str7 now str10
2021-03-11T12:16:35.463273100Z (50,000 real changes made)
2021-03-11T12:16:35.463275300Z (40,000 real changes made)
2021-03-11T12:16:35.463277400Z (40,000 missing values generated)
2021-03-11T12:16:35.463279800Z variable hba1c_new was str7 now str10
2021-03-11T12:16:35.463282000Z (50,000 real changes made)
2021-03-11T12:16:35.463284600Z (40,000 real changes made)
2021-03-11T12:16:35.463286800Z (40,000 missing values generated)
2021-03-11T12:16:35.463289000Z variable hba1c_old was str7 now str10
2021-03-11T12:16:35.463291300Z (50,000 real changes made)
2021-03-11T12:16:35.463293800Z (40,000 real changes made)
2021-03-11T12:16:35.463310100Z (40,000 missing values generated)
2021-03-11T12:16:35.463312200Z variable hba1c_mmol_per_mol_date was str7 now str10
2021-03-11T12:16:35.463314500Z (50,000 real changes made)
2021-03-11T12:16:35.463316700Z (2,500 real changes made)
2021-03-11T12:16:35.463318900Z (2,500 missing values generated)
2021-03-11T12:16:35.463321100Z variable hba1c_percentage_date was str7 now str10
2021-03-11T12:16:35.463323300Z (50,000 real changes made)
2021-03-11T12:16:35.463325500Z (2,500 real changes made)
2021-03-11T12:16:35.463327600Z (2,500 missing values generated)
2021-03-11T12:16:35.463330000Z variable diabetes was str7 now str10
2021-03-11T12:16:35.463332100Z (50,000 real changes made)
2021-03-11T12:16:35.463334400Z (40,000 real changes made)
2021-03-11T12:16:35.463336600Z (40,000 missing values generated)
2021-03-11T12:16:35.463338800Z variable hypertension was str7 now str10
2021-03-11T12:16:35.463341400Z (50,000 real changes made)
2021-03-11T12:16:35.463343500Z (40,000 real changes made)
2021-03-11T12:16:35.463346300Z (40,000 missing values generated)
2021-03-11T12:16:35.463348400Z variable chronic_respiratory_disease was str7 now str10
2021-03-11T12:16:35.463350600Z (50,000 real changes made)
2021-03-11T12:16:35.463352700Z (40,000 real changes made)
2021-03-11T12:16:35.463357400Z (40,000 missing values generated)
2021-03-11T12:16:35.463359800Z variable esrf was str7 now str10
2021-03-11T12:16:35.463362100Z (50,000 real changes made)
2021-03-11T12:16:35.463364400Z (45,000 real changes made)
2021-03-11T12:16:35.463367100Z (45,000 missing values generated)
2021-03-11T12:16:35.463369500Z variable copd was str7 now str10
2021-03-11T12:16:35.463371700Z (50,000 real changes made)
2021-03-11T12:16:35.463373800Z (40,000 real changes made)
2021-03-11T12:16:35.463375900Z (40,000 missing values generated)
2021-03-11T12:16:35.463378100Z variable chronic_liver_disease was str7 now str10
2021-03-11T12:16:35.463380400Z (50,000 real changes made)
2021-03-11T12:16:35.463382500Z (40,000 real changes made)
2021-03-11T12:16:35.463384700Z (40,000 missing values generated)
2021-03-11T12:16:35.463387000Z variable stroke was str7 now str10
2021-03-11T12:16:35.463389300Z (50,000 real changes made)
2021-03-11T12:16:35.463391500Z (40,000 real changes made)
2021-03-11T12:16:35.463393700Z (40,000 missing values generated)
2021-03-11T12:16:35.463395800Z variable lung_cancer was str7 now str10
2021-03-11T12:16:35.463398100Z (50,000 real changes made)
2021-03-11T12:16:35.463400200Z (40,000 real changes made)
2021-03-11T12:16:35.463402300Z (40,000 missing values generated)
2021-03-11T12:16:35.463404700Z variable haem_cancer was str7 now str10
2021-03-11T12:16:35.463407300Z (50,000 real changes made)
2021-03-11T12:16:35.463409900Z (40,000 real changes made)
2021-03-11T12:16:35.463412200Z (40,000 missing values generated)
2021-03-11T12:16:35.463414400Z variable other_cancer was str7 now str10
2021-03-11T12:16:35.463416600Z (50,000 real changes made)
2021-03-11T12:16:35.463419000Z (40,000 real changes made)
2021-03-11T12:16:35.463421100Z (40,000 missing values generated)
2021-03-11T12:16:35.463423300Z variable creatinine_date was str7 now str10
2021-03-11T12:16:35.463425600Z (50,000 real changes made)
2021-03-11T12:16:35.463427900Z (2,500 real changes made)
2021-03-11T12:16:35.463430100Z (2,500 missing values generated)
2021-03-11T12:16:35.463432200Z variable organ_transplant was str7 now str10
2021-03-11T12:16:35.463434400Z (50,000 real changes made)
2021-03-11T12:16:35.463436400Z (40,000 real changes made)
2021-03-11T12:16:35.463438900Z (40,000 missing values generated)
2021-03-11T12:16:35.463441600Z variable bmi_date_measured was str7 now str10
2021-03-11T12:16:35.463443900Z (50,000 real changes made)
2021-03-11T12:16:35.463446700Z (20,000 real changes made)
2021-03-11T12:16:35.463449400Z (20,000 missing values generated)
2021-03-11T12:16:35.463456500Z 
2021-03-11T12:16:35.463459600Z . 
2021-03-11T12:16:35.463461800Z . /*conversion for dates with day already included*/
2021-03-11T12:16:35.463465000Z . 
2021-03-11T12:16:35.463467200Z . foreach var of varlist   icu_date_admitted                                   
2021-03-11T12:16:35.463469600Z >    ///
2021-03-11T12:16:35.463471800Z >                                                  died_date_ons               
2021-03-11T12:16:35.463474100Z >                            ///
2021-03-11T12:16:35.463476500Z >                                                  first_pos_test_sgss         
2021-03-11T12:16:35.463478900Z >                    ///
2021-03-11T12:16:35.463481200Z >                                                  {
2021-03-11T12:16:35.463483400Z   2.                                                  
2021-03-11T12:16:35.463485600Z .                 capture confirm string variable `var'
2021-03-11T12:16:35.463488300Z   3.                 if _rc!=0 {
2021-03-11T12:16:35.463490900Z   4.                         assert `var'==.
2021-03-11T12:16:35.463493100Z   5.                         rename `var' `var'_date
2021-03-11T12:16:35.463495400Z   6.                 }
2021-03-11T12:16:35.463498200Z   7.         
2021-03-11T12:16:35.463500600Z .                 else {
2021-03-11T12:16:35.463503000Z   8.                                 rename `var' `var'_dstr
2021-03-11T12:16:35.463505600Z   9.                                 gen `var'_date = date(`var'_dstr, "YMD") 
2021-03-11T12:16:35.463508300Z  10.                                 order `var'_date, after(`var'_dstr)
2021-03-11T12:16:35.463510800Z  11.                                 drop `var'_dstr
2021-03-11T12:16:35.463513300Z  12.                                 gen `var'_date15 = `var'_date+15
2021-03-11T12:16:35.463515600Z  13.                                 order `var'_date15, after(`var'_date)
2021-03-11T12:16:35.463517900Z  14.                                 drop `var'_date
2021-03-11T12:16:35.463520500Z  15.                                 rename `var'_date15 `var'_date
2021-03-11T12:16:35.463522800Z  16.                 }
2021-03-11T12:16:35.463525100Z  17.         
2021-03-11T12:16:35.463527800Z .         format `var'_date %td
2021-03-11T12:16:35.463530500Z  18. }
2021-03-11T12:16:35.463532800Z (45,000 missing values generated)
2021-03-11T12:16:35.463535300Z (45,000 missing values generated)
2021-03-11T12:16:35.463561800Z (45,000 missing values generated)
2021-03-11T12:16:35.463568600Z (45,000 missing values generated)
2021-03-11T12:16:35.463571200Z (45,000 missing values generated)
2021-03-11T12:16:35.463573400Z (45,000 missing values generated)
2021-03-11T12:16:35.463575500Z 
2021-03-11T12:16:35.463582500Z .                                                  
2021-03-11T12:16:35.463585000Z . 
2021-03-11T12:16:35.463587300Z . /* RENAME VARAIBLES==========================================================
2021-03-11T12:16:35.463589600Z > =*/
2021-03-11T12:16:35.463591800Z . *  An extra 'date' added to the end of some variable names, remove 
2021-03-11T12:16:35.463594000Z . rename icu_date_admitted_date                   icu_admitted_date            
2021-03-11T12:16:35.463596500Z >            
2021-03-11T12:16:35.463598600Z 
2021-03-11T12:16:35.463600800Z . rename bmi_date_measured_date                   bmi_measured_date
2021-03-11T12:16:35.463603100Z 
2021-03-11T12:16:35.463605100Z . rename died_date_ons_date                       died_ons_date 
2021-03-11T12:16:35.463607400Z 
2021-03-11T12:16:35.463610500Z . rename creatinine_date_date                             creatinine_measured_d
2021-03-11T12:16:35.463612800Z > ate
2021-03-11T12:16:35.463614900Z 
2021-03-11T12:16:35.463616900Z . rename hba1c_mmol_per_mol_date_date             hba1c_mmol_per_mol_date 
2021-03-11T12:16:35.463619200Z 
2021-03-11T12:16:35.463621400Z . rename hba1c_percentage_date_date               hba1c_percentage_date
2021-03-11T12:16:35.463623600Z 
2021-03-11T12:16:35.463625900Z . 
2021-03-11T12:16:35.463628000Z . 
2021-03-11T12:16:35.463630100Z . * Some names too long for loops below, shorten
2021-03-11T12:16:35.463632400Z . 
2021-03-11T12:16:35.463634600Z . /* CREATE BINARY VARIABLES===================================================
2021-03-11T12:16:35.463636900Z > =*/
2021-03-11T12:16:35.463639000Z . 
2021-03-11T12:16:35.463641000Z . 
2021-03-11T12:16:35.463643100Z . *  Make indicator variables for all conditions where relevant 
2021-03-11T12:16:35.463645300Z . 
2021-03-11T12:16:35.463647400Z . 
2021-03-11T12:16:35.463649400Z . foreach var of varlist   crohns_disease_date                                /
2021-03-11T12:16:35.463651600Z > //
2021-03-11T12:16:35.463654900Z >                                                  ulcerative_colitis_date     
2021-03-11T12:16:35.463657200Z >                            ///
2021-03-11T12:16:35.463659500Z >                                                  ibd_uncla_date              
2021-03-11T12:16:35.463661900Z >            ///
2021-03-11T12:16:35.463664300Z >                                                  psoriasis_date              
2021-03-11T12:16:35.463666500Z >                                    ///
2021-03-11T12:16:35.463668700Z >                                                  atopic_dermatitis_date      
2021-03-11T12:16:35.463673800Z >                            ///
2021-03-11T12:16:35.463676300Z >                                                  hidradenitis_suppurativa_dat
2021-03-11T12:16:35.463678500Z > e                  ///
2021-03-11T12:16:35.463680700Z >                                                  psoriatic_arthritis_date    
2021-03-11T12:16:35.463683100Z >                            ///
2021-03-11T12:16:35.463685300Z >                                                  rheumatoid_arthritis_date   
2021-03-11T12:16:35.463687500Z >                ///
2021-03-11T12:16:35.463689800Z >                                                  ankylosing_spondylitis_date 
2021-03-11T12:16:35.463692100Z >                    ///
2021-03-11T12:16:35.463694700Z >                                                  chronic_cardiac_disease_date
2021-03-11T12:16:35.463697000Z >                    ///
2021-03-11T12:16:35.463699200Z >                                                  hypertension_date           
2021-03-11T12:16:35.463701500Z >                                    ///
2021-03-11T12:16:35.463703900Z >                                                  chronic_respiratory_disease_
2021-03-11T12:16:35.463706200Z > date               ///
2021-03-11T12:16:35.463708600Z >                                                  copd_date                   
2021-03-11T12:16:35.463710900Z >                                            ///
2021-03-11T12:16:35.463713000Z >                                                  chronic_liver_disease_date  
2021-03-11T12:16:35.463715500Z >                            ///
2021-03-11T12:16:35.463717600Z >                                                  stroke_date                 
2021-03-11T12:16:35.463719800Z >                                    ///
2021-03-11T12:16:35.463722100Z >                                                  lung_cancer_date            
2021-03-11T12:16:35.463724300Z >                                    ///
2021-03-11T12:16:35.463726400Z >                                                  haem_cancer_date            
2021-03-11T12:16:35.463728700Z >                                    ///
2021-03-11T12:16:35.463730800Z >                                                  other_cancer_date           
2021-03-11T12:16:35.463733000Z >                                    ///
2021-03-11T12:16:35.463735500Z >                                                  diabetes_date               
2021-03-11T12:16:35.463737700Z >                                    ///
2021-03-11T12:16:35.463740500Z >                                                  esrf_date                   
2021-03-11T12:16:35.463742800Z >                                            ///
2021-03-11T12:16:35.463745200Z >                                                  creatinine_measured_date    
2021-03-11T12:16:35.463750100Z >                ///
2021-03-11T12:16:35.463752400Z >                                                  organ_transplant_date       
2021-03-11T12:16:35.463754700Z >                            ///
2021-03-11T12:16:35.463756900Z >                                                  bmi_measured_date           
2021-03-11T12:16:35.463759200Z >                                ///
2021-03-11T12:16:35.463761400Z >                                                  icu_admitted_date           
2021-03-11T12:16:35.463763700Z >                                ///
2021-03-11T12:16:35.463765800Z >                                                  died_ons_date               
2021-03-11T12:16:35.463768100Z >                                    ///
2021-03-11T12:16:35.463770300Z >                                                  first_pos_test_sgss_date    
2021-03-11T12:16:35.463772500Z >    {
2021-03-11T12:16:35.463774700Z   2.         /* date ranges are applied in python, so presence of date indicate
2021-03-11T12:16:35.463777000Z > s presence of 
2021-03-11T12:16:35.463779200Z >           disease in the correct time frame */ 
2021-03-11T12:16:35.463781600Z .         local newvar =  substr("`var'", 1, length("`var'") - 5)
2021-03-11T12:16:35.463784100Z   3.         gen `newvar' = (`var'!=. )
2021-03-11T12:16:35.463786300Z   4.         order `newvar', after(`var')
2021-03-11T12:16:35.463788400Z   5. }
2021-03-11T12:16:35.463790600Z 
2021-03-11T12:16:35.463792700Z . 
2021-03-11T12:16:35.463794700Z . /* CREATE VARIABLES==========================================================
2021-03-11T12:16:35.463797000Z > =*/
2021-03-11T12:16:35.463799100Z . 
2021-03-11T12:16:35.463801200Z . /* DEMOGRAPHICS */ 
2021-03-11T12:16:35.463803400Z . 
2021-03-11T12:16:35.463815400Z . * Sex
2021-03-11T12:16:35.463819100Z . gen male = 1 if sex == "M"
2021-03-11T12:16:35.463821400Z (25,408 missing values generated)
2021-03-11T12:16:35.463823600Z 
2021-03-11T12:16:35.463825700Z . replace male = 0 if sex == "F"
2021-03-11T12:16:35.463828000Z (25,408 real changes made)
2021-03-11T12:16:35.463830100Z 
2021-03-11T12:16:35.463832200Z . 
2021-03-11T12:16:35.463834200Z . * Ethnicity
2021-03-11T12:16:35.463836400Z . replace ethnicity = .u if ethnicity == .
2021-03-11T12:16:35.463838700Z (12,500 real changes made, 12,500 to missing)
2021-03-11T12:16:35.463841000Z 
2021-03-11T12:16:35.463843000Z . 
2021-03-11T12:16:35.463845100Z . *rearrange in order of prevalence
2021-03-11T12:16:35.463850000Z . recode ethnicity 2=6 /* mixed to 6 */
2021-03-11T12:16:35.463852500Z (ethnicity: 0 changes made)
2021-03-11T12:16:35.463854800Z 
2021-03-11T12:16:35.463856900Z . recode ethnicity 3=2 /* south asian to 2 */
2021-03-11T12:16:35.463859100Z (ethnicity: 3721 changes made)
2021-03-11T12:16:35.463861200Z 
2021-03-11T12:16:35.463863300Z . recode ethnicity 4=3 /* black to 3 */
2021-03-11T12:16:35.463865500Z (ethnicity: 0 changes made)
2021-03-11T12:16:35.463867700Z 
2021-03-11T12:16:35.463869700Z . recode ethnicity 6=4 /* mixed to 4 */
2021-03-11T12:16:35.463871900Z (ethnicity: 0 changes made)
2021-03-11T12:16:35.463874000Z 
2021-03-11T12:16:35.463876100Z . 
2021-03-11T12:16:35.463878200Z . label define ethnicity  1 "White"                                       ///
2021-03-11T12:16:35.463880500Z >                                                 2 "South Asian"              
2021-03-11T12:16:35.463882900Z >            ///
2021-03-11T12:16:35.463885000Z >                                                 3 "Black"                    
2021-03-11T12:16:35.463887400Z >                    ///
2021-03-11T12:16:35.463889900Z >                                                 4 "Mixed"                    
2021-03-11T12:16:35.463892200Z >                    ///
2021-03-11T12:16:35.463894400Z >                                                 5 "Other"                    
2021-03-11T12:16:35.463896700Z >                    ///
2021-03-11T12:16:35.463899400Z >                                                 .u "Unknown"
2021-03-11T12:16:35.463901900Z 
2021-03-11T12:16:35.463904100Z . label values ethnicity ethnicity
2021-03-11T12:16:35.463906200Z 
2021-03-11T12:16:35.463908300Z . 
2021-03-11T12:16:35.463910400Z . gen ethnicity2 = ethnicity
2021-03-11T12:16:35.463912700Z (12,500 missing values generated)
2021-03-11T12:16:35.463914800Z 
2021-03-11T12:16:35.463916900Z . replace ethnicity2 = . if ethnicity == .u
2021-03-11T12:16:35.463919100Z (12,500 real changes made, 12,500 to missing)
2021-03-11T12:16:35.463921400Z 
2021-03-11T12:16:35.463923500Z . 
2021-03-11T12:16:35.463925600Z . * STP 
2021-03-11T12:16:35.463927700Z . rename stp stp_old
2021-03-11T12:16:35.463929900Z 
2021-03-11T12:16:35.463932000Z . bysort stp_old: gen stp = 1 if _n==1
2021-03-11T12:16:35.463934200Z (49,998 missing values generated)
2021-03-11T12:16:35.463936300Z 
2021-03-11T12:16:35.463938400Z . replace stp = sum(stp)
2021-03-11T12:16:35.463940600Z (49,999 real changes made)
2021-03-11T12:16:35.463947700Z 
2021-03-11T12:16:35.463950100Z . drop stp_old
2021-03-11T12:16:35.463952200Z 
2021-03-11T12:16:35.463954300Z . 
2021-03-11T12:16:35.463956400Z . /*  IMD  */
2021-03-11T12:16:35.463958500Z . * Group into 5 groups
2021-03-11T12:16:35.463960600Z . rename imd imd_o
2021-03-11T12:16:35.463962700Z 
2021-03-11T12:16:35.463964800Z . egen imd = cut(imd_o), group(5) icodes
2021-03-11T12:16:35.463967000Z 
2021-03-11T12:16:35.463969100Z . 
2021-03-11T12:16:35.463971100Z . * add one to create groups 1 - 5 
2021-03-11T12:16:35.463973300Z . replace imd = imd + 1
2021-03-11T12:16:35.463975400Z (50,000 real changes made)
2021-03-11T12:16:35.463977500Z 
2021-03-11T12:16:35.463979600Z . 
2021-03-11T12:16:35.463981800Z . * - 1 is missing, should be excluded from population 
2021-03-11T12:16:35.463984000Z . replace imd = .u if imd_o == -1
2021-03-11T12:16:35.463986100Z (0 real changes made)
2021-03-11T12:16:35.463988200Z 
2021-03-11T12:16:35.463990300Z . drop imd_o
2021-03-11T12:16:35.463992500Z 
2021-03-11T12:16:35.463994500Z . 
2021-03-11T12:16:35.463996600Z . * Reverse the order (so high is more deprived)
2021-03-11T12:16:35.463998800Z . recode imd 5 = 1 4 = 2 3 = 3 2 = 4 1 = 5 .u = .u
2021-03-11T12:16:35.464001000Z (imd: 50000 changes made)
2021-03-11T12:16:35.464003200Z 
2021-03-11T12:16:35.464005400Z . 
2021-03-11T12:16:35.464007500Z . label define imd 1 "1 least deprived" 2 "2" 3 "3" 4 "4" 5 "5 most deprived" .
2021-03-11T12:16:35.464010200Z > u "Unknown"
2021-03-11T12:16:35.464012500Z 
2021-03-11T12:16:35.464014700Z . label values imd imd 
2021-03-11T12:16:35.464016900Z 
2021-03-11T12:16:35.464018900Z . 
2021-03-11T12:16:35.464021000Z . /*  Age variables  */ 
2021-03-11T12:16:35.464023200Z . ********works if ages 18 and over
2021-03-11T12:16:35.464025400Z . * Create categorised age
2021-03-11T12:16:35.464027500Z . drop if age<18 & age !=.
2021-03-11T12:16:35.464029800Z (10,655 observations deleted)
2021-03-11T12:16:35.464031900Z 
2021-03-11T12:16:35.464034100Z . drop if age>109 & age !=.
2021-03-11T12:16:35.464036300Z (0 observations deleted)
2021-03-11T12:16:35.464038500Z 
2021-03-11T12:16:35.464040500Z . 
2021-03-11T12:16:35.464042800Z . recode age 18/39.9999 = 1 /// 
2021-03-11T12:16:35.464045000Z >            40/49.9999 = 2 ///
2021-03-11T12:16:35.464047200Z >                    50/59.9999 = 3 ///
2021-03-11T12:16:35.464051600Z >                60/69.9999 = 4 ///
2021-03-11T12:16:35.464054000Z >                    70/79.9999 = 5 ///
2021-03-11T12:16:35.464056200Z >                    80/max = 6, gen(agegroup) 
2021-03-11T12:16:35.464058500Z (39345 differences between age and agegroup)
2021-03-11T12:16:35.464060700Z 
2021-03-11T12:16:35.464062900Z . 
2021-03-11T12:16:35.464065000Z . label define agegroup   1 "18-<40" ///
2021-03-11T12:16:35.464067400Z >                                                 2 "40-<50" ///
2021-03-11T12:16:35.464069800Z >                                                 3 "50-<60" ///
2021-03-11T12:16:35.464072200Z >                                                 4 "60-<70" ///
2021-03-11T12:16:35.464074500Z >                                                 5 "70-<80" ///
2021-03-11T12:16:35.464076700Z >                                                 6 "80+"
2021-03-11T12:16:35.464079100Z 
2021-03-11T12:16:35.464081100Z .                                                 
2021-03-11T12:16:35.464084100Z . label values agegroup agegroup
2021-03-11T12:16:35.464086300Z 
2021-03-11T12:16:35.464088400Z . 
2021-03-11T12:16:35.464090500Z . * Create binary age
2021-03-11T12:16:35.464092600Z . recode age min/69.999 = 0 ///
2021-03-11T12:16:35.464094800Z >            70/max = 1, gen(age70)
2021-03-11T12:16:35.464097100Z (39345 differences between age and age70)
2021-03-11T12:16:35.464099400Z 
2021-03-11T12:16:35.464101500Z . 
2021-03-11T12:16:35.464103600Z . * Check there are no missing ages
2021-03-11T12:16:35.464105700Z . assert age < .
2021-03-11T12:16:35.464107900Z 
2021-03-11T12:16:35.464110100Z . assert agegroup < .
2021-03-11T12:16:35.464112600Z 
2021-03-11T12:16:35.464114700Z . assert age70 < .
2021-03-11T12:16:35.464117000Z 
2021-03-11T12:16:35.464119300Z . 
2021-03-11T12:16:35.464121500Z . * Create restricted cubic splines for age
2021-03-11T12:16:35.464123800Z . mkspline age = age, cubic nknots(4)
2021-03-11T12:16:35.464126000Z 
2021-03-11T12:16:35.464128100Z . 
2021-03-11T12:16:35.464130200Z . /*  Body Mass Index  */
2021-03-11T12:16:35.464132500Z . * NB: watch for missingness
2021-03-11T12:16:35.464134600Z . 
2021-03-11T12:16:35.464136700Z . * Recode strange values 
2021-03-11T12:16:35.464139000Z . replace bmi = . if bmi == 0 
2021-03-11T12:16:35.464141100Z (15,730 real changes made, 15,730 to missing)
2021-03-11T12:16:35.464146100Z 
2021-03-11T12:16:35.464149900Z . replace bmi = . if !inrange(bmi, 10, 60)
2021-03-11T12:16:35.464152000Z (297 real changes made, 297 to missing)
2021-03-11T12:16:35.464154200Z 
2021-03-11T12:16:35.464156600Z . 
2021-03-11T12:16:35.464158700Z . * Restrict to within 10 years of index and aged > 16 
2021-03-11T12:16:35.464161000Z . gen bmi_time = (date("$indexdate", "DMY") - bmi_measured_date)/365.25
2021-03-11T12:16:35.464163400Z (15,730 missing values generated)
2021-03-11T12:16:35.464165600Z 
2021-03-11T12:16:35.464167700Z . gen bmi_age = age - bmi_time
2021-03-11T12:16:35.464169800Z (15,730 missing values generated)
2021-03-11T12:16:35.464172100Z 
2021-03-11T12:16:35.464174300Z . 
2021-03-11T12:16:35.464176800Z . replace bmi = . if bmi_age < 16 
2021-03-11T12:16:35.464179200Z (16,837 real changes made, 16,837 to missing)
2021-03-11T12:16:35.464181800Z 
2021-03-11T12:16:35.464184000Z . replace bmi = . if bmi_time > 10 & bmi_time != . 
2021-03-11T12:16:35.464186300Z (4,508 real changes made, 4,508 to missing)
2021-03-11T12:16:35.464188500Z 
2021-03-11T12:16:35.464190700Z . 
2021-03-11T12:16:35.464192900Z . * Set to missing if no date, and vice versa 
2021-03-11T12:16:35.464195100Z . replace bmi = . if bmi_measured_date == . 
2021-03-11T12:16:35.464197300Z (0 real changes made)
2021-03-11T12:16:35.464199600Z 
2021-03-11T12:16:35.464201700Z . replace bmi_measured_date = . if bmi == . 
2021-03-11T12:16:35.464203900Z (21,642 real changes made, 21,642 to missing)
2021-03-11T12:16:35.464206100Z 
2021-03-11T12:16:35.464208200Z . replace bmi_measured_date = . if bmi == . 
2021-03-11T12:16:35.464210400Z (0 real changes made)
2021-03-11T12:16:35.464212600Z 
2021-03-11T12:16:35.464214600Z . 
2021-03-11T12:16:35.464216900Z . gen     bmicat = .
2021-03-11T12:16:35.464219300Z (39,345 missing values generated)
2021-03-11T12:16:35.464221600Z 
2021-03-11T12:16:35.464224200Z . recode  bmicat . = 1 if bmi < 18.5
2021-03-11T12:16:35.464226800Z (bmicat: 98 changes made)
2021-03-11T12:16:35.464228900Z 
2021-03-11T12:16:35.464231000Z . recode  bmicat . = 2 if bmi < 25
2021-03-11T12:16:35.464233300Z (bmicat: 212 changes made)
2021-03-11T12:16:35.464235500Z 
2021-03-11T12:16:35.464237500Z . recode  bmicat . = 3 if bmi < 30
2021-03-11T12:16:35.464240100Z (bmicat: 287 changes made)
2021-03-11T12:16:35.464242200Z 
2021-03-11T12:16:35.464244300Z . recode  bmicat . = 4 if bmi < 35
2021-03-11T12:16:35.464246700Z (bmicat: 367 changes made)
2021-03-11T12:16:35.464251900Z 
2021-03-11T12:16:35.464254400Z . recode  bmicat . = 5 if bmi < 40
2021-03-11T12:16:35.464257200Z (bmicat: 397 changes made)
2021-03-11T12:16:35.464259500Z 
2021-03-11T12:16:35.464261700Z . recode  bmicat . = 6 if bmi < .
2021-03-11T12:16:35.464263900Z (bmicat: 612 changes made)
2021-03-11T12:16:35.464266100Z 
2021-03-11T12:16:35.464268200Z . replace bmicat = .u if bmi >= .
2021-03-11T12:16:35.464270500Z (37,372 real changes made, 37,372 to missing)
2021-03-11T12:16:35.464272600Z 
2021-03-11T12:16:35.464274700Z . 
2021-03-11T12:16:35.464276800Z . label define bmicat 1 "Underweight (<18.5)"     ///
2021-03-11T12:16:35.464279300Z >                                         2 "Normal (18.5-24.9)"          ///
2021-03-11T12:16:35.464281900Z >                                         3 "Overweight (25-29.9)"        ///
2021-03-11T12:16:35.464284800Z >                                         4 "Obese I (30-34.9)"           ///
2021-03-11T12:16:35.464287300Z >                                         5 "Obese II (35-39.9)"          ///
2021-03-11T12:16:35.464289900Z >                                         6 "Obese III (40+)"                  
2021-03-11T12:16:35.464292300Z >    ///
2021-03-11T12:16:35.464294400Z >                                         .u "Unknown (.u)"
2021-03-11T12:16:35.464296700Z 
2021-03-11T12:16:35.464298800Z .                                         
2021-03-11T12:16:35.464301100Z . label values bmicat bmicat
2021-03-11T12:16:35.464303500Z 
2021-03-11T12:16:35.464305600Z . 
2021-03-11T12:16:35.464307700Z . * Create less  granular categorisation
2021-03-11T12:16:35.464309900Z . recode bmicat 1/3 .u = 1 4 = 2 5 = 3 6 = 4, gen(obese4cat)
2021-03-11T12:16:35.464312200Z (39247 differences between bmicat and obese4cat)
2021-03-11T12:16:35.464314400Z 
2021-03-11T12:16:35.464316600Z . 
2021-03-11T12:16:35.464318700Z . label define obese4cat  1 "No record of obesity"        ///
2021-03-11T12:16:35.464321000Z >                                                 2 "Obese I (30-34.9)"        
2021-03-11T12:16:35.464323300Z >    ///
2021-03-11T12:16:35.464325400Z >                                                 3 "Obese II (35-39.9)"       
2021-03-11T12:16:35.464327800Z >    ///
2021-03-11T12:16:35.464330100Z >                                                 4 "Obese III (40+)"          
2021-03-11T12:16:35.464333100Z >    
2021-03-11T12:16:35.464335600Z 
2021-03-11T12:16:35.464338600Z . 
2021-03-11T12:16:35.464340700Z . label values obese4cat obese4cat
2021-03-11T12:16:35.464345500Z 
2021-03-11T12:16:35.464347900Z . order obese4cat, after(bmicat)
2021-03-11T12:16:35.464350200Z 
2021-03-11T12:16:35.464352400Z . 
2021-03-11T12:16:35.464354600Z . /*  Smoking  */
2021-03-11T12:16:35.464357100Z . 
2021-03-11T12:16:35.464359200Z . * Smoking 
2021-03-11T12:16:35.464361700Z . label define smoke 1 "Never" 2 "Former" 3 "Current" .u "Unknown (.u)"
2021-03-11T12:16:35.464364500Z 
2021-03-11T12:16:35.464366500Z . 
2021-03-11T12:16:35.464368600Z . gen     smoke = 1  if smoking_status == "N"
2021-03-11T12:16:35.464371000Z (38,551 missing values generated)
2021-03-11T12:16:35.464373200Z 
2021-03-11T12:16:35.464375300Z . replace smoke = 2  if smoking_status == "E"
2021-03-11T12:16:35.464377500Z (389 real changes made)
2021-03-11T12:16:35.464379600Z 
2021-03-11T12:16:35.464381800Z . replace smoke = 3  if smoking_status == "S"
2021-03-11T12:16:35.464384100Z (2,362 real changes made)
2021-03-11T12:16:35.464386200Z 
2021-03-11T12:16:35.464388300Z . replace smoke = .u if smoking_status == "M"
2021-03-11T12:16:35.464390600Z (375 real changes made, 375 to missing)
2021-03-11T12:16:35.464392800Z 
2021-03-11T12:16:35.464395000Z . replace smoke = .u if smoking_status == "" 
2021-03-11T12:16:35.464397500Z (35,425 real changes made, 35,425 to missing)
2021-03-11T12:16:35.464399700Z 
2021-03-11T12:16:35.464401700Z . 
2021-03-11T12:16:35.464403700Z . label values smoke smoke
2021-03-11T12:16:35.464405900Z 
2021-03-11T12:16:35.464408100Z . drop smoking_status
2021-03-11T12:16:35.464410400Z 
2021-03-11T12:16:35.464412700Z . 
2021-03-11T12:16:35.464414800Z . * Create non-missing 3-category variable for current smoking
2021-03-11T12:16:35.464417400Z . * Assumes missing smoking is never smoking 
2021-03-11T12:16:35.464419800Z . recode smoke .u = 1, gen(smoke_nomiss)
2021-03-11T12:16:35.464422100Z (35800 differences between smoke and smoke_nomiss)
2021-03-11T12:16:35.464424400Z 
2021-03-11T12:16:35.464426600Z . order smoke_nomiss, after(smoke)
2021-03-11T12:16:35.464428800Z 
2021-03-11T12:16:35.464430800Z . label values smoke_nomiss smoke
2021-03-11T12:16:35.464433000Z 
2021-03-11T12:16:35.464435000Z . 
2021-03-11T12:16:35.464437100Z . 
2021-03-11T12:16:35.464439300Z . /* CLINICAL COMORBIDITIES */ 
2021-03-11T12:16:35.464441500Z . 
2021-03-11T12:16:35.464443600Z . /* GP consultation rate */ 
2021-03-11T12:16:35.464449500Z . replace gp_consult_count = 0 if gp_consult_count <1 
2021-03-11T12:16:35.464451900Z (172 real changes made)
2021-03-11T12:16:35.464454100Z 
2021-03-11T12:16:35.464456300Z . 
2021-03-11T12:16:35.464458400Z . * those with no count assumed to have no visits 
2021-03-11T12:16:35.464460700Z . replace gp_consult_count = 0 if gp_consult_count == . 
2021-03-11T12:16:35.464463300Z (0 real changes made)
2021-03-11T12:16:35.464465500Z 
2021-03-11T12:16:35.464467500Z . gen gp_consult = (gp_consult_count >=1)
2021-03-11T12:16:35.464469800Z 
2021-03-11T12:16:35.464471900Z . 
2021-03-11T12:16:35.464473900Z . 
2021-03-11T12:16:35.464476000Z . /* eGFR */
2021-03-11T12:16:35.464478200Z . 
2021-03-11T12:16:35.464480400Z . * Set implausible creatinine values to missing (Note: zero changed to missing
2021-03-11T12:16:35.464482600Z > )
2021-03-11T12:16:35.464484800Z . replace creatinine = . if !inrange(creatinine, 20, 3000) 
2021-03-11T12:16:35.464487100Z (11,491 real changes made, 11,491 to missing)
2021-03-11T12:16:35.464489200Z 
2021-03-11T12:16:35.464491400Z . 
2021-03-11T12:16:35.464493400Z . * Remove creatinine dates if no measurements, and vice versa 
2021-03-11T12:16:35.464495900Z . 
2021-03-11T12:16:35.464497900Z . replace creatinine = . if creatinine_measured_date == . 
2021-03-11T12:16:35.464500200Z (0 real changes made)
2021-03-11T12:16:35.464502600Z 
2021-03-11T12:16:35.464504600Z . replace creatinine_measured_date = . if creatinine == . 
2021-03-11T12:16:35.464506800Z (9,550 real changes made, 9,550 to missing)
2021-03-11T12:16:35.464509300Z 
2021-03-11T12:16:35.464511400Z . 
2021-03-11T12:16:35.464513400Z . 
2021-03-11T12:16:35.464515500Z . * Divide by 88.4 (to convert umol/l to mg/dl)
2021-03-11T12:16:35.464517600Z . gen SCr_adj = creatinine/88.4
2021-03-11T12:16:35.464519800Z (11,491 missing values generated)
2021-03-11T12:16:35.464521900Z 
2021-03-11T12:16:35.464524000Z . 
2021-03-11T12:16:35.464526300Z . gen min = .
2021-03-11T12:16:35.464528700Z (39,345 missing values generated)
2021-03-11T12:16:35.464546800Z 
2021-03-11T12:16:35.464554300Z . replace min = SCr_adj/0.7 if male==0
2021-03-11T12:16:35.464557600Z (14,074 real changes made)
2021-03-11T12:16:35.464560000Z 
2021-03-11T12:16:35.464562300Z . replace min = SCr_adj/0.9 if male==1
2021-03-11T12:16:35.464564900Z (13,780 real changes made)
2021-03-11T12:16:35.464567200Z 
2021-03-11T12:16:35.464569200Z . replace min = min^-0.329  if male==0
2021-03-11T12:16:35.464576300Z (14,074 real changes made)
2021-03-11T12:16:35.464578800Z 
2021-03-11T12:16:35.464580900Z . replace min = min^-0.411  if male==1
2021-03-11T12:16:35.464583200Z (13,780 real changes made)
2021-03-11T12:16:35.464585300Z 
2021-03-11T12:16:35.464587800Z . replace min = 1 if min<1
2021-03-11T12:16:35.464590000Z (24,526 real changes made)
2021-03-11T12:16:35.464592200Z 
2021-03-11T12:16:35.464594600Z . 
2021-03-11T12:16:35.464596800Z . gen max=.
2021-03-11T12:16:35.464598900Z (39,345 missing values generated)
2021-03-11T12:16:35.464601000Z 
2021-03-11T12:16:35.464603200Z . replace max=SCr_adj/0.7 if male==0
2021-03-11T12:16:35.464605600Z (14,074 real changes made)
2021-03-11T12:16:35.464608100Z 
2021-03-11T12:16:35.464610200Z . replace max=SCr_adj/0.9 if male==1
2021-03-11T12:16:35.464612400Z (13,780 real changes made)
2021-03-11T12:16:35.464614400Z 
2021-03-11T12:16:35.464616900Z . replace max=max^-1.209
2021-03-11T12:16:35.464619000Z (27,854 real changes made)
2021-03-11T12:16:35.464621100Z 
2021-03-11T12:16:35.464623100Z . replace max=1 if max>1
2021-03-11T12:16:35.464625400Z (14,819 real changes made)
2021-03-11T12:16:35.464627800Z 
2021-03-11T12:16:35.464629800Z . 
2021-03-11T12:16:35.464631900Z . gen egfr=min*max*141
2021-03-11T12:16:35.464634000Z (11,491 missing values generated)
2021-03-11T12:16:35.464636500Z 
2021-03-11T12:16:35.464638600Z . replace egfr=egfr*(0.993^age)
2021-03-11T12:16:35.464640900Z (27,854 real changes made)
2021-03-11T12:16:35.464643000Z 
2021-03-11T12:16:35.464645100Z . replace egfr=egfr*1.018 if male==0
2021-03-11T12:16:35.464647200Z (14,074 real changes made)
2021-03-11T12:16:35.464649300Z 
2021-03-11T12:16:35.464651700Z . label var egfr "egfr calculated using CKD-EPI formula with no eth"
2021-03-11T12:16:35.464654100Z 
2021-03-11T12:16:35.464656100Z . 
2021-03-11T12:16:35.464658200Z . * Categorise into ckd stages
2021-03-11T12:16:35.464660400Z . egen egfr_cat_all = cut(egfr), at(0, 15, 30, 45, 60, 5000)
2021-03-11T12:16:35.464662600Z (11491 missing values generated)
2021-03-11T12:16:35.464664800Z 
2021-03-11T12:16:35.464667100Z . recode egfr_cat_all 0 = 5 15 = 4 30 = 3 45 = 2 60 = 0, generate(ckd_egfr)
2021-03-11T12:16:35.464669400Z (27854 differences between egfr_cat_all and ckd_egfr)
2021-03-11T12:16:35.464671600Z 
2021-03-11T12:16:35.464673800Z . 
2021-03-11T12:16:35.464675800Z . /* 
2021-03-11T12:16:35.464681000Z > 0 "No CKD, eGFR>60"     or missing -- have been shown reasonable in CPRD
2021-03-11T12:16:35.464683700Z > 2 "stage 3a, eGFR 45-59" 
2021-03-11T12:16:35.464686000Z > 3 "stage 3b, eGFR 30-44" 
2021-03-11T12:16:35.464688200Z > 4 "stage 4, eGFR 15-29" 
2021-03-11T12:16:35.464690600Z > 5 "stage 5, eGFR <15"
2021-03-11T12:16:35.464692900Z > */
2021-03-11T12:16:35.464695000Z . 
2021-03-11T12:16:35.464697100Z . gen egfr_cat = .
2021-03-11T12:16:35.464699900Z (39,345 missing values generated)
2021-03-11T12:16:35.464702500Z 
2021-03-11T12:16:35.464704700Z . recode egfr_cat . = 3 if egfr < 30
2021-03-11T12:16:35.464706800Z (egfr_cat: 15575 changes made)
2021-03-11T12:16:35.464709100Z 
2021-03-11T12:16:35.464711200Z . recode egfr_cat . = 2 if egfr < 60
2021-03-11T12:16:35.464713500Z (egfr_cat: 6278 changes made)
2021-03-11T12:16:35.464716000Z 
2021-03-11T12:16:35.464718300Z . recode egfr_cat . = 1 if egfr < .
2021-03-11T12:16:35.464720500Z (egfr_cat: 6001 changes made)
2021-03-11T12:16:35.464723000Z 
2021-03-11T12:16:35.464725100Z . replace egfr_cat = .u if egfr >= .
2021-03-11T12:16:35.464727500Z (11,491 real changes made, 11,491 to missing)
2021-03-11T12:16:35.464729700Z 
2021-03-11T12:16:35.464731700Z . 
2021-03-11T12:16:35.464733800Z . label define egfr_cat   1 ">=60"                ///
2021-03-11T12:16:35.464736100Z >                                                 2 "30-59"               ///
2021-03-11T12:16:35.464738600Z >                                                 3 "<30"                 ///
2021-03-11T12:16:35.464740900Z >                                                 .u "Unknown (.u)"
2021-03-11T12:16:35.464743300Z 
2021-03-11T12:16:35.464745400Z .                                         
2021-03-11T12:16:35.464747600Z . label values egfr_cat egfr_cat
2021-03-11T12:16:35.464749900Z 
2021-03-11T12:16:35.464752200Z . 
2021-03-11T12:16:35.464754200Z . *if missing eGFR, assume normal
2021-03-11T12:16:35.464756400Z . 
2021-03-11T12:16:35.464758800Z . gen egfr_cat_nomiss = egfr_cat
2021-03-11T12:16:35.464761000Z (11,491 missing values generated)
2021-03-11T12:16:35.464763200Z 
2021-03-11T12:16:35.464765400Z . replace egfr_cat_nomiss = 1 if egfr_cat == .u
2021-03-11T12:16:35.464767600Z (11,491 real changes made)
2021-03-11T12:16:35.464769700Z 
2021-03-11T12:16:35.464771900Z . 
2021-03-11T12:16:35.464774000Z . label define egfr_cat_nomiss    1 ">=60/missing"        ///
2021-03-11T12:16:35.464779200Z >                                                                 2 "30-59"    
2021-03-11T12:16:35.464781700Z >                    ///
2021-03-11T12:16:35.464783900Z >                                                                 3 "<30" 
2021-03-11T12:16:35.464786200Z 
2021-03-11T12:16:35.464788300Z . label values egfr_cat_nomiss egfr_cat_nomiss
2021-03-11T12:16:35.464790400Z 
2021-03-11T12:16:35.464792500Z . 
2021-03-11T12:16:35.464794600Z . gen egfr_date = creatinine_measured_date
2021-03-11T12:16:35.464796800Z (11,491 missing values generated)
2021-03-11T12:16:35.464798900Z 
2021-03-11T12:16:35.464801000Z . format egfr_date %td
2021-03-11T12:16:35.464803200Z 
2021-03-11T12:16:35.464836100Z . 
2021-03-11T12:16:35.464841200Z . * Add in end stage renal failure and create a single CKD variable 
2021-03-11T12:16:35.464843600Z . * Missing assumed to not have CKD 
2021-03-11T12:16:35.464845800Z . gen ckd = 0
2021-03-11T12:16:35.464847900Z 
2021-03-11T12:16:35.464850000Z . replace ckd = 1 if ckd_egfr != . & ckd_egfr >= 1
2021-03-11T12:16:35.464852300Z (21,853 real changes made)
2021-03-11T12:16:35.464854400Z 
2021-03-11T12:16:35.464856500Z . replace ckd = 1 if esrf == 1
2021-03-11T12:16:35.464858600Z (1,743 real changes made)
2021-03-11T12:16:35.464860800Z 
2021-03-11T12:16:35.464862800Z . 
2021-03-11T12:16:35.464864800Z . label define ckd 0 "No CKD" 1 "CKD"
2021-03-11T12:16:35.464867100Z 
2021-03-11T12:16:35.464869200Z . label values ckd ckd
2021-03-11T12:16:35.464871300Z 
2021-03-11T12:16:35.464876900Z . label var ckd "CKD stage calc without eth"
2021-03-11T12:16:35.464879200Z 
2021-03-11T12:16:35.464881200Z . 
2021-03-11T12:16:35.464883400Z . * Create date (most recent measure prior to index)
2021-03-11T12:16:35.464885500Z . gen temp1_ckd_date = creatinine_measured_date if ckd_egfr >=1
2021-03-11T12:16:35.464887800Z (17,492 missing values generated)
2021-03-11T12:16:35.464890000Z 
2021-03-11T12:16:35.464892100Z . gen temp2_ckd_date = esrf_date if esrf == 1
2021-03-11T12:16:35.464894400Z (35,444 missing values generated)
2021-03-11T12:16:35.464896600Z 
2021-03-11T12:16:35.464898600Z . gen ckd_date = max(temp1_ckd_date,temp2_ckd_date) 
2021-03-11T12:16:35.464900800Z (15,749 missing values generated)
2021-03-11T12:16:35.464902900Z 
2021-03-11T12:16:35.464905400Z . format ckd_date %td 
2021-03-11T12:16:35.464907500Z 
2021-03-11T12:16:35.464909500Z . 
2021-03-11T12:16:35.464915100Z . /* HbA1c */
2021-03-11T12:16:35.464917400Z . 
2021-03-11T12:16:35.464919500Z . /*  Diabetes severity  */
2021-03-11T12:16:35.464921600Z . 
2021-03-11T12:16:35.464924300Z . * Set zero or negative to missing
2021-03-11T12:16:35.464926700Z . replace hba1c_percentage   = . if hba1c_percentage <= 0
2021-03-11T12:16:35.464928900Z (2,202 real changes made, 2,202 to missing)
2021-03-11T12:16:35.464931100Z 
2021-03-11T12:16:35.464933200Z . replace hba1c_mmol_per_mol = . if hba1c_mmol_per_mol <= 0
2021-03-11T12:16:35.464935500Z (2,790 real changes made, 2,790 to missing)
2021-03-11T12:16:35.464937600Z 
2021-03-11T12:16:35.464939600Z . 
2021-03-11T12:16:35.464941700Z . * Set most recent values of >15 months prior to index to missing
2021-03-11T12:16:35.464944100Z . replace hba1c_percentage   = . if (date("$indexdate", "DMY") - hba1c_percenta
2021-03-11T12:16:35.464946500Z > ge_date) > 15*30 & hba1c_percentage_date != .
2021-03-11T12:16:35.464948800Z (36,764 real changes made, 36,764 to missing)
2021-03-11T12:16:35.464951000Z 
2021-03-11T12:16:35.464953200Z . replace hba1c_mmol_per_mol = . if (date("$indexdate", "DMY") - hba1c_mmol_per
2021-03-11T12:16:35.464955500Z > _mol_date) > 15*30 & hba1c_mmol_per_mol_date != .
2021-03-11T12:16:35.464957800Z (36,168 real changes made, 36,168 to missing)
2021-03-11T12:16:35.464960000Z 
2021-03-11T12:16:35.464962100Z . 
2021-03-11T12:16:35.464964200Z . * Clean up dates
2021-03-11T12:16:35.464966300Z . replace hba1c_percentage_date = . if hba1c_percentage == .
2021-03-11T12:16:35.464968500Z (36,993 real changes made, 36,993 to missing)
2021-03-11T12:16:35.464970600Z 
2021-03-11T12:16:35.464972700Z . replace hba1c_mmol_per_mol_date = . if hba1c_mmol_per_mol == .
2021-03-11T12:16:35.464974900Z (36,988 real changes made, 36,988 to missing)
2021-03-11T12:16:35.464977000Z 
2021-03-11T12:16:35.464979100Z . 
2021-03-11T12:16:35.464981200Z . /* Express  HbA1c as percentage  */ 
2021-03-11T12:16:35.464983400Z . 
2021-03-11T12:16:35.464985600Z . * Express all values as perecentage 
2021-03-11T12:16:35.464987900Z . noi summ hba1c_percentage hba1c_mmol_per_mol 
2021-03-11T12:16:35.464990100Z 
2021-03-11T12:16:35.464992200Z     Variable |        Obs        Mean    Std. Dev.       Min        Max
2021-03-11T12:16:35.464994400Z -------------+---------------------------------------------------------
2021-03-11T12:16:35.464996700Z hba1c_per~ge |        379    5.029938    2.079852   .0135052   10.46472
2021-03-11T12:16:35.464999000Z hba1c_mmol~l |        387    41.85022    19.48007   3.414989   102.1984
2021-03-11T12:16:35.465003700Z 
2021-03-11T12:16:35.465006200Z . gen     hba1c_pct = hba1c_percentage 
2021-03-11T12:16:35.465008300Z (38,966 missing values generated)
2021-03-11T12:16:35.465010500Z 
2021-03-11T12:16:35.465012600Z . replace hba1c_pct = (hba1c_mmol_per_mol/10.929)+2.15 if hba1c_mmol_per_mol<. 
2021-03-11T12:16:35.465014900Z (387 real changes made)
2021-03-11T12:16:35.465017100Z 
2021-03-11T12:16:35.465019200Z . 
2021-03-11T12:16:35.465021300Z . * Valid % range between 0-20  
2021-03-11T12:16:35.465023400Z . replace hba1c_pct = . if !inrange(hba1c_pct, 0, 20) 
2021-03-11T12:16:35.465025600Z (0 real changes made)
2021-03-11T12:16:35.465027700Z 
2021-03-11T12:16:35.465029700Z . replace hba1c_pct = round(hba1c_pct, 0.1)
2021-03-11T12:16:35.465031900Z (764 real changes made)
2021-03-11T12:16:35.465034000Z 
2021-03-11T12:16:35.465036000Z . 
2021-03-11T12:16:35.465038100Z . /* Categorise hba1c and diabetes  */
2021-03-11T12:16:35.465040300Z . 
2021-03-11T12:16:35.465042300Z . * Group hba1c
2021-03-11T12:16:35.465044400Z . gen     hba1ccat = 0 if hba1c_pct <  6.5
2021-03-11T12:16:35.465046600Z (38,814 missing values generated)
2021-03-11T12:16:35.465048800Z 
2021-03-11T12:16:35.465050900Z . replace hba1ccat = 1 if hba1c_pct >= 6.5  & hba1c_pct < 7.5
2021-03-11T12:16:35.465053200Z (98 real changes made)
2021-03-11T12:16:35.465055300Z 
2021-03-11T12:16:35.465057400Z . replace hba1ccat = 2 if hba1c_pct >= 7.5  & hba1c_pct < 8
2021-03-11T12:16:35.465059700Z (34 real changes made)
2021-03-11T12:16:35.465061800Z 
2021-03-11T12:16:35.465063900Z . replace hba1ccat = 3 if hba1c_pct >= 8    & hba1c_pct < 9
2021-03-11T12:16:35.465067300Z (67 real changes made)
2021-03-11T12:16:35.465069600Z 
2021-03-11T12:16:35.465071700Z . replace hba1ccat = 4 if hba1c_pct >= 9    & hba1c_pct !=.
2021-03-11T12:16:35.465074000Z (34 real changes made)
2021-03-11T12:16:35.465076300Z 
2021-03-11T12:16:35.465078300Z . label define hba1ccat 0 "<6.5%" 1">=6.5-7.4" 2">=7.5-7.9" 3">=8-8.9" 4">=9"
2021-03-11T12:16:35.465081000Z 
2021-03-11T12:16:35.465083100Z . label values hba1ccat hba1ccat
2021-03-11T12:16:35.465085400Z 
2021-03-11T12:16:35.465087400Z . 
2021-03-11T12:16:35.465089500Z . * Create diabetes, split by control/not
2021-03-11T12:16:35.465091700Z . gen     diabcat = 1 if diabetes==0
2021-03-11T12:16:35.465093900Z (7,857 missing values generated)
2021-03-11T12:16:35.465096000Z 
2021-03-11T12:16:35.465100100Z . replace diabcat = 2 if diabetes==1 & inlist(hba1ccat, 0, 1)
2021-03-11T12:16:35.465102500Z (126 real changes made)
2021-03-11T12:16:35.465104600Z 
2021-03-11T12:16:35.465106700Z . replace diabcat = 3 if diabetes==1 & inlist(hba1ccat, 2, 3, 4)
2021-03-11T12:16:35.465109000Z (30 real changes made)
2021-03-11T12:16:35.465111100Z 
2021-03-11T12:16:35.465113200Z . replace diabcat = 4 if diabetes==1 & !inlist(hba1ccat, 0, 1, 2, 3, 4)
2021-03-11T12:16:35.465115500Z (7,701 real changes made)
2021-03-11T12:16:35.465117600Z 
2021-03-11T12:16:35.465119600Z . 
2021-03-11T12:16:35.465121700Z . label define diabcat    1 "No diabetes"                         ///
2021-03-11T12:16:35.465124100Z >                                                 2 "Controlled diabetes"      
2021-03-11T12:16:35.465126400Z >    ///
2021-03-11T12:16:35.465128600Z >                                                 3 "Uncontrolled diabetes"    
2021-03-11T12:16:35.465130900Z >    ///
2021-03-11T12:16:35.465133000Z >                                                 4 "Diabetes, no hba1c measure
2021-03-11T12:16:35.465135400Z > "
2021-03-11T12:16:35.465152100Z 
2021-03-11T12:16:35.465157300Z . label values diabcat diabcat
2021-03-11T12:16:35.465160000Z 
2021-03-11T12:16:35.465162400Z . 
2021-03-11T12:16:35.465164600Z . * create cancer *variable 'other cancer currently' includes carcinoma of the 
2021-03-11T12:16:35.465166900Z > head and neck - need to confirm if this excludes NMSC
2021-03-11T12:16:35.465169100Z . gen cancer =0
2021-03-11T12:16:35.465171200Z 
2021-03-11T12:16:35.465173300Z . replace cancer =1 if lung_cancer ==1 | haem_cancer ==1 | other_cancer ==1
2021-03-11T12:16:35.465175500Z (19,200 real changes made)
2021-03-11T12:16:35.465177600Z 
2021-03-11T12:16:35.465179600Z . 
2021-03-11T12:16:35.465181700Z . *creat other comorbid variables
2021-03-11T12:16:35.465183900Z . gen combined_cv_comorbid =1 if chronic_cardiac_disease ==1 | stroke==1
2021-03-11T12:16:35.465186100Z (25,234 missing values generated)
2021-03-11T12:16:35.465188200Z 
2021-03-11T12:16:35.465190300Z . 
2021-03-11T12:16:35.465192300Z . 
2021-03-11T12:16:35.465194400Z . * Delete unneeded variables
2021-03-11T12:16:35.465196600Z . drop hba1c_pct hba1c_percentage hba1c_mmol_per_mol
2021-03-11T12:16:35.465198800Z 
2021-03-11T12:16:35.465200800Z . 
2021-03-11T12:16:35.465203000Z . *****************************************************************************
2021-03-11T12:16:35.465205200Z > ********************
2021-03-11T12:16:35.465211400Z . /* POPULATIONS =============================================================*
2021-03-11T12:16:35.465214500Z > /
2021-03-11T12:16:35.465216600Z . 
2021-03-11T12:16:35.465218600Z . /* Diagnosis =============*/
2021-03-11T12:16:35.465220700Z . *include only most recent diagnosis within each specialty
2021-03-11T12:16:35.465222900Z . *Rheum
2021-03-11T12:16:35.465225000Z . replace rheumatoid_arthritis =0 if psoriatic_arthritis_date > rheumatoid_arth
2021-03-11T12:16:35.465230100Z > ritis_date & psoriatic_arthritis_date !=.
2021-03-11T12:16:35.465232400Z (816 real changes made)
2021-03-11T12:16:35.465234400Z 
2021-03-11T12:16:35.465236500Z . replace rheumatoid_arthritis =0 if ankylosing_spondylitis_date > rheumatoid_a
2021-03-11T12:16:35.465238900Z > rthritis_date & ankylosing_spondylitis_date !=.
2021-03-11T12:16:35.465241600Z (613 real changes made)
2021-03-11T12:16:35.465243900Z 
2021-03-11T12:16:35.465246000Z . replace psoriatic_arthritis     =0 if rheumatoid_arthritis_date > psoriatic_a
2021-03-11T12:16:35.465248500Z > rthritis_date & rheumatoid_arthritis_date !=.
2021-03-11T12:16:35.465250800Z (821 real changes made)
2021-03-11T12:16:35.465253000Z 
2021-03-11T12:16:35.465255100Z . replace psoriatic_arthritis     =0 if ankylosing_spondylitis_date > psoriatic
2021-03-11T12:16:35.465257600Z > _arthritis_date & ankylosing_spondylitis_date !=.
2021-03-11T12:16:35.465259900Z (642 real changes made)
2021-03-11T12:16:35.465262100Z 
2021-03-11T12:16:35.465264100Z . replace ankylosing_spondylitis =0 if psoriatic_arthritis_date > ankylosing_sp
2021-03-11T12:16:35.465266400Z > ondylitis_date & psoriatic_arthritis_date !=.
2021-03-11T12:16:35.465268700Z (794 real changes made)
2021-03-11T12:16:35.465270800Z 
2021-03-11T12:16:35.465273000Z . replace ankylosing_spondylitis =0 if rheumatoid_arthritis_date > ankylosing_s
2021-03-11T12:16:35.465275300Z > pondylitis_date & rheumatoid_arthritis_date !=.
2021-03-11T12:16:35.465277500Z (684 real changes made)
2021-03-11T12:16:35.465279600Z 
2021-03-11T12:16:35.465281600Z . 
2021-03-11T12:16:35.465283600Z .  
2021-03-11T12:16:35.465285800Z . *Derm
2021-03-11T12:16:35.465287900Z . replace psoriasis =0 if hidradenitis_suppurativa_date > psoriasis_date & hidr
2021-03-11T12:16:35.465290100Z > adenitis_suppurativa_date !=.
2021-03-11T12:16:35.465292300Z (830 real changes made)
2021-03-11T12:16:35.465294400Z 
2021-03-11T12:16:35.465310100Z . *replace psoriasis =0 if atopic_dermatitis_date > psoriasis_date & atopic_der
2021-03-11T12:16:35.465312300Z > matitis_date !=.
2021-03-11T12:16:35.465317200Z . replace hidradenitis_suppurativa =0 if psoriasis_date > hidradenitis_suppurat
2021-03-11T12:16:35.465319800Z > iva_date & psoriasis_date !=.
2021-03-11T12:16:35.465321900Z (805 real changes made)
2021-03-11T12:16:35.465323900Z 
2021-03-11T12:16:35.465326000Z . *replace hidradenitis_suppurativa =0 if atopic_dermatitis_date > hidradenitis
2021-03-11T12:16:35.465328200Z > _suppurativa_date & atopic_dermatitis_date !=.
2021-03-11T12:16:35.465330400Z . replace atopic_dermatitis =0 if psoriasis_date > atopic_dermatitis_date & pso
2021-03-11T12:16:35.465332600Z > riasis_date !=.
2021-03-11T12:16:35.465334600Z (778 real changes made)
2021-03-11T12:16:35.465336700Z 
2021-03-11T12:16:35.465338700Z . replace atopic_dermatitis =0 if hidradenitis_suppurativa_date > atopic_dermat
2021-03-11T12:16:35.465340900Z > itis_date & hidradenitis_suppurativa_date !=.
2021-03-11T12:16:35.465343000Z (684 real changes made)
2021-03-11T12:16:35.465345100Z 
2021-03-11T12:16:35.465347200Z . 
2021-03-11T12:16:35.465349300Z . *Gastro
2021-03-11T12:16:35.465351400Z . replace ibd_uncla =0 if ulcerative_colitis_date > ibd_uncla_date  & ulcerativ
2021-03-11T12:16:35.465353600Z > e_colitis_date !=.
2021-03-11T12:16:35.465355700Z (738 real changes made)
2021-03-11T12:16:35.465357800Z 
2021-03-11T12:16:35.465359700Z . replace ibd_uncla =0 if crohns_disease_date > ibd_uncla_date  & crohns_diseas
2021-03-11T12:16:35.465362000Z > e_date !=.
2021-03-11T12:16:35.465364100Z (628 real changes made)
2021-03-11T12:16:35.465366100Z 
2021-03-11T12:16:35.465368100Z . replace ulcerative_colitis =0 if crohns_disease_date > ulcerative_colitis_dat
2021-03-11T12:16:35.465370400Z > e & crohns_disease_date !=.
2021-03-11T12:16:35.465373300Z (808 real changes made)
2021-03-11T12:16:35.465375300Z 
2021-03-11T12:16:35.465377400Z . replace ulcerative_colitis =0 if ibd_uncla_date > ulcerative_colitis_date & i
2021-03-11T12:16:35.465379700Z > bd_uncla_date !=.
2021-03-11T12:16:35.465381800Z (676 real changes made)
2021-03-11T12:16:35.465383900Z 
2021-03-11T12:16:35.465385900Z . replace crohns_disease =0 if ulcerative_colitis_date > crohns_disease_date & 
2021-03-11T12:16:35.465388400Z > ulcerative_colitis_date !=.
2021-03-11T12:16:35.465390600Z (778 real changes made)
2021-03-11T12:16:35.465392600Z 
2021-03-11T12:16:35.465394600Z . replace crohns_disease =0 if ibd_uncla_date > crohns_disease_date & ibd_uncla
2021-03-11T12:16:35.465396900Z > _date !=.
2021-03-11T12:16:35.465398900Z (715 real changes made)
2021-03-11T12:16:35.465403200Z 
2021-03-11T12:16:35.465405500Z . 
2021-03-11T12:16:35.465407700Z . *consider the effect of patients diagnosed with imid post 1st March 2020
2021-03-11T12:16:35.465409900Z . *ignoring this will bias to null
2021-03-11T12:16:35.465412000Z . *diagnoses after 1st March have been culled via python code
2021-03-11T12:16:35.465414100Z . 
2021-03-11T12:16:35.465416100Z . gen imid = .
2021-03-11T12:16:35.465418100Z (39,345 missing values generated)
2021-03-11T12:16:35.465420300Z 
2021-03-11T12:16:35.465422300Z . replace imid = 1 if rheumatoid_arthritis ==1 | psoriatic_arthritis ==1 | anky
2021-03-11T12:16:35.465424500Z > losing_spondylitis==1 | ibd_uncla ==1 | ulcerative_colitis ==1 | crohns_disea
2021-03-11T12:16:35.465426700Z > se ==1 | psoriasis ==1 | hidradenitis_suppurativa ==1
2021-03-11T12:16:35.465428900Z (32,766 real changes made)
2021-03-11T12:16:35.465431000Z 
2021-03-11T12:16:35.465433000Z . replace imid = 0 if rheumatoid_arthritis !=1 & psoriatic_arthritis !=1 & ibd_
2021-03-11T12:16:35.465435200Z > uncla !=1 & ulcerative_colitis !=1 & crohns_disease !=1 & psoriasis !=1 & hid
2021-03-11T12:16:35.465437600Z > radenitis_suppurativa !=1 & ankylosing_spondylitis !=1
2021-03-11T12:16:35.465439800Z (6,579 real changes made)
2021-03-11T12:16:35.465441800Z 
2021-03-11T12:16:35.465443800Z . 
2021-03-11T12:16:35.465445800Z . label define imid 0 "Gen Pop" 1 "IMID"
2021-03-11T12:16:35.465448000Z 
2021-03-11T12:16:35.465450000Z . label values imid imid
2021-03-11T12:16:35.465452000Z 
2021-03-11T12:16:35.465454000Z . 
2021-03-11T12:16:35.465456000Z . gen bowel =0
2021-03-11T12:16:35.465458000Z 
2021-03-11T12:16:35.465460000Z . replace bowel =1 if crohns_disease ==1 | ibd_uncla ==1 | ulcerative_colitis =
2021-03-11T12:16:35.465462200Z > =1
2021-03-11T12:16:35.465464200Z (19,294 real changes made)
2021-03-11T12:16:35.465466200Z 
2021-03-11T12:16:35.465468200Z . label define bowel 0 "Gen Pop" 1 "Bowel"
2021-03-11T12:16:35.465470600Z 
2021-03-11T12:16:35.465472600Z . label values bowel bowel
2021-03-11T12:16:35.465474800Z 
2021-03-11T12:16:35.465476700Z . 
2021-03-11T12:16:35.465478700Z . gen skin =0
2021-03-11T12:16:35.465480800Z 
2021-03-11T12:16:35.465482900Z . replace skin =1 if psoriasis ==1 | hidradenitis_suppurativa ==1
2021-03-11T12:16:35.465485000Z (14,130 real changes made)
2021-03-11T12:16:35.465487100Z 
2021-03-11T12:16:35.465489000Z . label define skin 0 "Gen Pop" 1 "Skin"
2021-03-11T12:16:35.465495400Z 
2021-03-11T12:16:35.465497800Z . label values skin skin
2021-03-11T12:16:35.465499900Z 
2021-03-11T12:16:35.465501900Z . 
2021-03-11T12:16:35.465503900Z . gen joint =0
2021-03-11T12:16:35.465505900Z 
2021-03-11T12:16:35.465507900Z . replace joint =1 if rheumatoid_arthritis ==1 | psoriatic_arthritis ==1 | anky
2021-03-11T12:16:35.465510000Z > losing_spondylitis ==1
2021-03-11T12:16:35.465512100Z (19,139 real changes made)
2021-03-11T12:16:35.465514100Z 
2021-03-11T12:16:35.465516200Z . label define joint 0 "Gen Pop" 1 "Joint"
2021-03-11T12:16:35.465518400Z 
2021-03-11T12:16:35.465520300Z . label values joint joint
2021-03-11T12:16:35.465522400Z 
2021-03-11T12:16:35.465524300Z . 
2021-03-11T12:16:35.465526300Z . 
2021-03-11T12:16:35.465528300Z . *Loop to replace missing with 0
2021-03-11T12:16:35.465530400Z . foreach var of varlist  oral_prednisolone_3m_0m  ///
2021-03-11T12:16:35.465532600Z >                                                 oral_prednisolone_6m_3m  /// 
2021-03-11T12:16:35.465534800Z >                                                 adalimumab_3m_0m             
2021-03-11T12:16:35.465536900Z >     ///
2021-03-11T12:16:35.465539000Z >                                                 adalimumab_6m_3m             
2021-03-11T12:16:35.465541200Z >     ///
2021-03-11T12:16:35.465543300Z >                                                 abatacept_3m_0m              
2021-03-11T12:16:35.465545500Z >     ///
2021-03-11T12:16:35.465547900Z >                                                 abatacept_6m_3m              
2021-03-11T12:16:35.465550100Z >     ///
2021-03-11T12:16:35.465552100Z >                                                 certolizumab_3m_0m           
2021-03-11T12:16:35.465554300Z >     ///
2021-03-11T12:16:35.465556300Z >                                                 certolizumab_6m_3m       ///
2021-03-11T12:16:35.465558500Z >                                                 etanercept_3m_0m             
2021-03-11T12:16:35.465560700Z >     ///
2021-03-11T12:16:35.465576900Z >                                                 etanercept_6m_3m             
2021-03-11T12:16:35.465582000Z >     ///
2021-03-11T12:16:35.465584700Z >                                                 golimumab_3m_0m              
2021-03-11T12:16:35.465587100Z >     ///
2021-03-11T12:16:35.465589200Z >                                                 golimumab_6m_3m              
2021-03-11T12:16:35.465591300Z >     ///
2021-03-11T12:16:35.465593400Z >                                                 infliximab_3m_0m             
2021-03-11T12:16:35.465599600Z >     ///
2021-03-11T12:16:35.465601800Z >                                                 infliximab_6m_3m             
2021-03-11T12:16:35.465604000Z >     ///
2021-03-11T12:16:35.465606000Z >                                                 sarilumab_3m_0m              
2021-03-11T12:16:35.465608400Z >     ///
2021-03-11T12:16:35.465610400Z >                                                 sarilumab_6m_3m              
2021-03-11T12:16:35.465612600Z >     ///
2021-03-11T12:16:35.465614700Z >                                                 tocilizumab_3m_0m            
2021-03-11T12:16:35.465616900Z >     ///
2021-03-11T12:16:35.465619300Z >                                                 tocilizumab_6m_3m            
2021-03-11T12:16:35.465621500Z >     ///
2021-03-11T12:16:35.465623600Z >                                                 ustekinumab_3m_0m            
2021-03-11T12:16:35.465625700Z >     ///
2021-03-11T12:16:35.465627800Z >                                                 ustekinumab_6m_3m            
2021-03-11T12:16:35.465630000Z >     ///
2021-03-11T12:16:35.465632200Z >                                                 guselkumab_3m_0m             
2021-03-11T12:16:35.465634800Z >     ///
2021-03-11T12:16:35.465636800Z >                                                 guselkumab_6m_3m             
2021-03-11T12:16:35.465638900Z >     ///
2021-03-11T12:16:35.465641100Z >                                                 tildrakizumab_3m_0m      ///
2021-03-11T12:16:35.465643400Z >                                                 tildrakizumab_6m_3m      ///
2021-03-11T12:16:35.465655900Z >                                                 risankizumab_3m_0m           
2021-03-11T12:16:35.465660000Z >     ///
2021-03-11T12:16:35.465662500Z >                                                 risankizumab_6m_3m           
2021-03-11T12:16:35.465664800Z >     ///
2021-03-11T12:16:35.465667000Z >                                                 secukinumab_3m_0m            
2021-03-11T12:16:35.465669200Z >     ///
2021-03-11T12:16:35.465671300Z >                                                 secukinumab_6m_3m            
2021-03-11T12:16:35.465673400Z >     ///
2021-03-11T12:16:35.465675800Z >                                                 ixekizumab_3m_0m             
2021-03-11T12:16:35.465678000Z >     ///
2021-03-11T12:16:35.465680000Z >                                                 ixekizumab_6m_3m             
2021-03-11T12:16:35.465682200Z >     ///
2021-03-11T12:16:35.465684200Z >                                                 brodalumab_3m_0m             
2021-03-11T12:16:35.465689900Z >     ///
2021-03-11T12:16:35.465692100Z >                                                 brodalumab_6m_3m             
2021-03-11T12:16:35.465694300Z >     ///
2021-03-11T12:16:35.465696400Z >                                                 baricitinib_3m_0m            
2021-03-11T12:16:35.465698600Z >     ///
2021-03-11T12:16:35.465700600Z >                                                 baricitinib_6m_3m            
2021-03-11T12:16:35.465702800Z >     ///
2021-03-11T12:16:35.465704800Z >                                                 tofacitinib_3m_0m            
2021-03-11T12:16:35.465707000Z >     ///
2021-03-11T12:16:35.465709000Z >                                                 tofacitinib_6m_3m            
2021-03-11T12:16:35.465711200Z >     ///
2021-03-11T12:16:35.465713200Z >                                                 rituximab_12m_6m             
2021-03-11T12:16:35.465715400Z >     ///
2021-03-11T12:16:35.465717400Z >                                                 rituximab_6m_3m              
2021-03-11T12:16:35.465719500Z >     ///
2021-03-11T12:16:35.465721600Z >                                                 rituximab_3m_0m              
2021-03-11T12:16:35.465723700Z >     ///
2021-03-11T12:16:35.465725800Z >                                                 azathioprine_3m_0m           
2021-03-11T12:16:35.465728000Z >     ///
2021-03-11T12:16:35.465730000Z >                                                 azathioprine_6m_3m           
2021-03-11T12:16:35.465732200Z >     ///
2021-03-11T12:16:35.465734300Z >                                                 ciclosporin_3m_0m            
2021-03-11T12:16:35.465736500Z >     ///
2021-03-11T12:16:35.465738500Z >                                                 ciclosporin_6m_3m            
2021-03-11T12:16:35.465740700Z >     ///
2021-03-11T12:16:35.465742800Z >                                                 gold_3m_0m                   
2021-03-11T12:16:35.465745200Z >             ///
2021-03-11T12:16:35.465747400Z >                                                 gold_6m_3m                   
2021-03-11T12:16:35.465749600Z >             ///
2021-03-11T12:16:35.465751600Z >                                                 leflunomide_3m_0m            
2021-03-11T12:16:35.465753800Z >     ///
2021-03-11T12:16:35.465755800Z >                                                 leflunomide_6m_3m            
2021-03-11T12:16:35.465758000Z >     ///
2021-03-11T12:16:35.465760100Z >                                                 mercaptopurine_3m_0m     ///
2021-03-11T12:16:35.465762400Z >                                                 mercaptopurine_6m_3m     ///
2021-03-11T12:16:35.465767000Z >                                                 methotrexate_3m_0m           
2021-03-11T12:16:35.465769700Z >     ///
2021-03-11T12:16:35.465771800Z >                                                 methotrexate_6m_3m           
2021-03-11T12:16:35.465774000Z >     ///
2021-03-11T12:16:35.465776400Z >                                                 methotrexate_hcd_3m_0m   /// 
2021-03-11T12:16:35.465778600Z >    
2021-03-11T12:16:35.465780700Z >                                                 methotrexate_hcd_6m_3m   ///
2021-03-11T12:16:35.465782800Z >                                                 mycophenolate_3m_0m          
2021-03-11T12:16:35.465785000Z >     ///
2021-03-11T12:16:35.465787100Z >                                                 mycophenolate_6m_3m          
2021-03-11T12:16:35.465789200Z >     ///
2021-03-11T12:16:35.465791300Z >                                                 penicillamine_3m_0m          
2021-03-11T12:16:35.465793600Z >     ///
2021-03-11T12:16:35.465795700Z >                                                 penicillamine_6m_3m          
2021-03-11T12:16:35.465797800Z >     ///
2021-03-11T12:16:35.465799900Z >                                                 sulfasalazine_3m_0m          
2021-03-11T12:16:35.465802100Z > ///
2021-03-11T12:16:35.465804100Z >                                                 sulfasalazine_6m_3m          
2021-03-11T12:16:35.465956100Z >     ///
2021-03-11T12:16:35.465961700Z >                                                 mesalazine_3m_0m             
2021-03-11T12:16:35.465963900Z >     ///
2021-03-11T12:16:35.465966100Z >                                                 mesalazine_6m_3m        {
2021-03-11T12:16:35.465968300Z   2.                                                 
2021-03-11T12:16:35.465970500Z .                                                 replace `var' =0 if `var' ==.
2021-03-11T12:16:35.465972700Z   3.                                                 }
2021-03-11T12:16:35.465974800Z (0 real changes made)
2021-03-11T12:16:35.465976900Z (0 real changes made)
2021-03-11T12:16:35.465979000Z (0 real changes made)
2021-03-11T12:16:35.465981100Z (0 real changes made)
2021-03-11T12:16:35.465983300Z (0 real changes made)
2021-03-11T12:16:35.465985300Z (0 real changes made)
2021-03-11T12:16:35.465987300Z (0 real changes made)
2021-03-11T12:16:35.465989400Z (0 real changes made)
2021-03-11T12:16:35.465991400Z (0 real changes made)
2021-03-11T12:16:35.465993400Z (0 real changes made)
2021-03-11T12:16:35.465995500Z (0 real changes made)
2021-03-11T12:16:35.466001300Z (0 real changes made)
2021-03-11T12:16:35.466003600Z (0 real changes made)
2021-03-11T12:16:35.466005700Z (0 real changes made)
2021-03-11T12:16:35.466007700Z (0 real changes made)
2021-03-11T12:16:35.466009800Z (0 real changes made)
2021-03-11T12:16:35.466012500Z (0 real changes made)
2021-03-11T12:16:35.466014600Z (0 real changes made)
2021-03-11T12:16:35.466016600Z (0 real changes made)
2021-03-11T12:16:35.466018600Z (0 real changes made)
2021-03-11T12:16:35.466020700Z (0 real changes made)
2021-03-11T12:16:35.466022700Z (0 real changes made)
2021-03-11T12:16:35.466024700Z (0 real changes made)
2021-03-11T12:16:35.466026800Z (0 real changes made)
2021-03-11T12:16:35.466028800Z (0 real changes made)
2021-03-11T12:16:35.466030900Z (0 real changes made)
2021-03-11T12:16:35.466032900Z (0 real changes made)
2021-03-11T12:16:35.466034900Z (0 real changes made)
2021-03-11T12:16:35.466036900Z (0 real changes made)
2021-03-11T12:16:35.466039000Z (0 real changes made)
2021-03-11T12:16:35.466041000Z (0 real changes made)
2021-03-11T12:16:35.466043100Z (0 real changes made)
2021-03-11T12:16:35.466045100Z (0 real changes made)
2021-03-11T12:16:35.466047100Z (0 real changes made)
2021-03-11T12:16:35.466049100Z (0 real changes made)
2021-03-11T12:16:35.466051200Z (0 real changes made)
2021-03-11T12:16:35.466053200Z (0 real changes made)
2021-03-11T12:16:35.466055300Z (0 real changes made)
2021-03-11T12:16:35.466057400Z (0 real changes made)
2021-03-11T12:16:35.466059400Z (0 real changes made)
2021-03-11T12:16:35.466061400Z (0 real changes made)
2021-03-11T12:16:35.466063400Z (0 real changes made)
2021-03-11T12:16:35.466065400Z (0 real changes made)
2021-03-11T12:16:35.466067500Z (0 real changes made)
2021-03-11T12:16:35.466069500Z (0 real changes made)
2021-03-11T12:16:35.466071500Z (0 real changes made)
2021-03-11T12:16:35.466073600Z (0 real changes made)
2021-03-11T12:16:35.466076000Z (0 real changes made)
2021-03-11T12:16:35.466078200Z (0 real changes made)
2021-03-11T12:16:35.466080200Z (0 real changes made)
2021-03-11T12:16:35.466082300Z (0 real changes made)
2021-03-11T12:16:35.466084300Z (0 real changes made)
2021-03-11T12:16:35.466086400Z (0 real changes made)
2021-03-11T12:16:35.466088400Z (0 real changes made)
2021-03-11T12:16:35.466090400Z (0 real changes made)
2021-03-11T12:16:35.466092500Z (0 real changes made)
2021-03-11T12:16:35.466096900Z (0 real changes made)
2021-03-11T12:16:35.466099200Z (0 real changes made)
2021-03-11T12:16:35.466101200Z (0 real changes made)
2021-03-11T12:16:35.466103200Z (0 real changes made)
2021-03-11T12:16:35.466105300Z (0 real changes made)
2021-03-11T12:16:35.466107300Z 
2021-03-11T12:16:35.466109300Z . 
2021-03-11T12:16:35.466111300Z . 
2021-03-11T12:16:35.466113400Z . *stand sys drugs data are count, not binary!
2021-03-11T12:16:35.466115500Z . gen standsys =1 if azathioprine_3m_0m >=1 | azathioprine_6m_3m >=1 | ciclospo
2021-03-11T12:16:35.466117900Z > rin_3m_0m >=1 |ciclosporin_6m_3m >=1 | leflunomide_3m_0m >=1 |leflunomide_6m_
2021-03-11T12:16:35.466120200Z > 3m >=1 | mercaptopurine_3m_0m >=1 |mercaptopurine_6m_3m >=1 | methotrexate_3m
2021-03-11T12:16:35.466122500Z > _0m >=1 | methotrexate_6m_3m >=1 | methotrexate_hcd_3m_0m >=1 | methotrexate_
2021-03-11T12:16:35.466125000Z > hcd_6m_3m >=1 | mycophenolate_3m_0m >=1 | mycophenolate_6m_3m >=1 | sulfasala
2021-03-11T12:16:35.466127300Z > zine_3m_0m >=1 |sulfasalazine_6m_3m >=1 | mesalazine_3m_0m >=1 | mesalazine_6
2021-03-11T12:16:35.466129600Z > m_3m >=1
2021-03-11T12:16:35.466131700Z (7,778 missing values generated)
2021-03-11T12:16:35.466133800Z 
2021-03-11T12:16:35.466135800Z . replace standsys =. if imid !=1
2021-03-11T12:16:35.466137900Z (5,261 real changes made, 5,261 to missing)
2021-03-11T12:16:35.466140000Z 
2021-03-11T12:16:35.466142000Z . 
2021-03-11T12:16:35.466144100Z . gen standsys3m =1 if azathioprine_3m_0m >=1 | ciclosporin_3m_0m >=1 | lefluno
2021-03-11T12:16:35.466146300Z > mide_3m_0m >=1 | mercaptopurine_3m_0m >=1 | methotrexate_3m_0m >=1 | methotre
2021-03-11T12:16:35.466148700Z > xate_hcd_3m_0m >=1 | mycophenolate_3m_0m >=1 | sulfasalazine_3m_0m >=1  | mes
2021-03-11T12:16:35.466151000Z > alazine_3m_0m >=1
2021-03-11T12:16:35.466153100Z (17,583 missing values generated)
2021-03-11T12:16:35.466155200Z 
2021-03-11T12:16:35.466157200Z . replace standsys3m =. if imid !=1
2021-03-11T12:16:35.466159300Z (3,590 real changes made, 3,590 to missing)
2021-03-11T12:16:35.466161400Z 
2021-03-11T12:16:35.466163500Z . 
2021-03-11T12:16:35.466165500Z . gen tnf =1 if adalimumab_6m_3m !=0 | adalimumab_3m_0m !=0 | certolizumab_6m_3
2021-03-11T12:16:35.466167700Z > m !=0 | certolizumab_3m_0m !=0 | etanercept_6m_3m !=0 | etanercept_3m_0m !=0 
2021-03-11T12:16:35.466169900Z > | golimumab_6m_3m !=0 | golimumab_3m_0m !=0 | infliximab_6m_3m !=0 | inflixim
2021-03-11T12:16:35.466172100Z > ab_3m_0m !=0
2021-03-11T12:16:35.466174100Z (13,627 missing values generated)
2021-03-11T12:16:35.466178400Z 
2021-03-11T12:16:35.466180500Z . replace tnf =. if imid !=1
2021-03-11T12:16:35.466182700Z (4,293 real changes made, 4,293 to missing)
2021-03-11T12:16:35.466184800Z 
2021-03-11T12:16:35.466186800Z . 
2021-03-11T12:16:35.466188900Z . gen tnfmono =1 if tnf==1 & standsys !=1
2021-03-11T12:16:35.466191000Z (35,077 missing values generated)
2021-03-11T12:16:35.466193100Z 
2021-03-11T12:16:35.466195000Z . recode tnfmono .=0 if tnf==1 & standsys ==1
2021-03-11T12:16:35.466197200Z (tnfmono: 17157 changes made)
2021-03-11T12:16:35.466199300Z 
2021-03-11T12:16:35.466201300Z . 
2021-03-11T12:16:35.466203300Z . label define tnfmono    0 "TNF combination"                     ///
2021-03-11T12:16:35.466205600Z >                                                 1 "TNF monotherapy"     
2021-03-11T12:16:35.466207800Z 
2021-03-11T12:16:35.466209900Z . label values tnfmono tnfmono
2021-03-11T12:16:35.466212000Z 
2021-03-11T12:16:35.466214300Z . label var tnfmono "TNF strategy"
2021-03-11T12:16:35.466216500Z 
2021-03-11T12:16:35.466218500Z . 
2021-03-11T12:16:35.466220600Z . *high cost drug data pull through as binary variable, not count
2021-03-11T12:16:35.466222800Z . gen standtnf =1 if tnf ==1
2021-03-11T12:16:35.466224900Z (17,920 missing values generated)
2021-03-11T12:16:35.466227000Z 
2021-03-11T12:16:35.466229000Z . replace standtnf =0 if standsys ==1 & tnf !=1
2021-03-11T12:16:35.466231200Z (9,149 real changes made)
2021-03-11T12:16:35.466233300Z 
2021-03-11T12:16:35.466235400Z . 
2021-03-11T12:16:35.466237500Z . gen standtnf3m =1 if adalimumab_3m_0m ==1 | certolizumab_3m_0m ==1 | etanerce
2021-03-11T12:16:35.466239800Z > pt_3m_0m ==1 | golimumab_3m_0m ==1 | infliximab_3m_0m ==1
2021-03-11T12:16:35.466242000Z (23,190 missing values generated)
2021-03-11T12:16:35.466244000Z 
2021-03-11T12:16:35.466246100Z . replace standtnf3m =0 if adalimumab_3m_0m !=1 & certolizumab_3m_0m !=1 & etan
2021-03-11T12:16:35.466248300Z > ercept_3m_0m !=1 & golimumab_3m_0m !=1 & infliximab_3m_0m !=1 & standsys3m ==
2021-03-11T12:16:35.466250600Z > 1
2021-03-11T12:16:35.466252600Z (10,695 real changes made)
2021-03-11T12:16:35.466254700Z 
2021-03-11T12:16:35.466256700Z .                                 
2021-03-11T12:16:35.466258800Z . gen il23 =1 if ustekinumab_3m_0m !=0 | ustekinumab_6m_3m !=0 | guselkumab_3m_
2021-03-11T12:16:35.466261000Z > 0m !=0 | guselkumab_6m_3m !=0 | tildrakizumab_3m_0m !=0 | tildrakizumab_6m_3m
2021-03-11T12:16:35.466263200Z >  !=0 | risankizumab_3m_0m !=0 | risankizumab_6m_3m !=0 
2021-03-11T12:16:35.466273700Z (16,911 missing values generated)
2021-03-11T12:16:35.466276100Z 
2021-03-11T12:16:35.466278100Z . replace il23 =. if imid !=1
2021-03-11T12:16:35.466280200Z (3,744 real changes made, 3,744 to missing)
2021-03-11T12:16:35.466282300Z 
2021-03-11T12:16:35.466284300Z . 
2021-03-11T12:16:35.466286300Z . gen standil23 =1 if il23 ==1
2021-03-11T12:16:35.466289000Z (20,655 missing values generated)
2021-03-11T12:16:35.466291100Z 
2021-03-11T12:16:35.466293100Z . replace standil23 =0 if standsys ==1 & il23 !=1
2021-03-11T12:16:35.466295200Z (11,247 real changes made)
2021-03-11T12:16:35.466297300Z 
2021-03-11T12:16:35.466299300Z . 
2021-03-11T12:16:35.466301300Z . gen standil233m =1 if ustekinumab_3m_0m ==1 | guselkumab_3m_0m ==1 | tildraki
2021-03-11T12:16:35.466303500Z > zumab_3m_0m ==1 | risankizumab_3m_0m ==1 
2021-03-11T12:16:35.466305600Z (25,760 missing values generated)
2021-03-11T12:16:35.466307600Z 
2021-03-11T12:16:35.466309700Z . replace standil233m =0 if ustekinumab_3m_0m !=1 & guselkumab_3m_0m !=1 & tild
2021-03-11T12:16:35.466311900Z > rakizumab_3m_0m !=1 & risankizumab_3m_0m !=1 & standsys3m ==1
2021-03-11T12:16:35.466314100Z (11,910 real changes made)
2021-03-11T12:16:35.466316200Z 
2021-03-11T12:16:35.466318200Z . 
2021-03-11T12:16:35.466320200Z . gen jaki =1 if baricitinib_3m_0m !=0 | baricitinib_6m_3m !=0 | tofacitinib_3m
2021-03-11T12:16:35.466322400Z > _0m !=0 | tofacitinib_6m_3m !=0 
2021-03-11T12:16:35.466324500Z (25,861 missing values generated)
2021-03-11T12:16:35.466326600Z 
2021-03-11T12:16:35.466328600Z . replace jaki =. if imid !=1
2021-03-11T12:16:35.466330700Z (2,272 real changes made, 2,272 to missing)
2021-03-11T12:16:35.466332800Z 
2021-03-11T12:16:35.466334800Z . 
2021-03-11T12:16:35.466336700Z . gen standjaki =1 if jaki ==1
2021-03-11T12:16:35.466338800Z (28,133 missing values generated)
2021-03-11T12:16:35.466340900Z 
2021-03-11T12:16:35.466342900Z . replace standjaki =0 if standsys ==1 & jaki !=1
2021-03-11T12:16:35.466358500Z (17,242 real changes made)
2021-03-11T12:16:35.466360500Z 
2021-03-11T12:16:35.466362500Z . 
2021-03-11T12:16:35.466364500Z . gen standjaki3m =1 if baricitinib_3m_0m ==1 | tofacitinib_3m_0m ==1 
2021-03-11T12:16:35.466367000Z (31,887 missing values generated)
2021-03-11T12:16:35.466369100Z 
2021-03-11T12:16:35.466371000Z . replace standjaki3m =0 if baricitinib_3m_0m !=1 & tofacitinib_3m_0m !=1 & sta
2021-03-11T12:16:35.466375300Z > ndsys3m ==1
2021-03-11T12:16:35.466377900Z (14,716 real changes made)
2021-03-11T12:16:35.466380000Z 
2021-03-11T12:16:35.466382000Z . 
2021-03-11T12:16:35.466384000Z . gen ritux =1 if rituximab_3m_0m !=0 | rituximab_6m_3m !=0 | rituximab_12m_6m 
2021-03-11T12:16:35.466386100Z > !=0
2021-03-11T12:16:35.466388100Z (28,669 missing values generated)
2021-03-11T12:16:35.466390100Z 
2021-03-11T12:16:35.466392000Z . replace ritux =. if rheumatoid_arthritis !=1
2021-03-11T12:16:35.466394200Z (8,959 real changes made, 8,959 to missing)
2021-03-11T12:16:35.466396300Z 
2021-03-11T12:16:35.466398200Z . 
2021-03-11T12:16:35.466400300Z . gen standritux =1 if ritux ==1
2021-03-11T12:16:35.466402400Z (37,628 missing values generated)
2021-03-11T12:16:35.466404400Z 
2021-03-11T12:16:35.466406300Z . replace standritux =0 if standsys ==1 & ritux !=1
2021-03-11T12:16:35.466408400Z (24,946 real changes made)
2021-03-11T12:16:35.466410400Z 
2021-03-11T12:16:35.466412400Z . 
2021-03-11T12:16:35.466414300Z . gen standritux3m =1 if rituximab_3m_0m ==1
2021-03-11T12:16:35.466416400Z (35,395 missing values generated)
2021-03-11T12:16:35.466418400Z 
2021-03-11T12:16:35.466420400Z . replace standritux3m =0 if rituximab_3m_0m !=1 & standsys3m ==1
2021-03-11T12:16:35.466422500Z (16,351 real changes made)
2021-03-11T12:16:35.466424500Z 
2021-03-11T12:16:35.466426400Z . 
2021-03-11T12:16:35.466428400Z . gen il6 =1 if sarilumab_3m_0m !=0 | sarilumab_6m_3m !=0 | tocilizumab_3m_0m !
2021-03-11T12:16:35.466430500Z > =0 | tocilizumab_6m_3m !=0
2021-03-11T12:16:35.466432500Z (25,728 missing values generated)
2021-03-11T12:16:35.466434600Z 
2021-03-11T12:16:35.466436600Z . replace il6 =. if rheumatoid_arthritis !=1
2021-03-11T12:16:35.466438600Z (11,464 real changes made, 11,464 to missing)
2021-03-11T12:16:35.466440700Z 
2021-03-11T12:16:35.466442700Z . 
2021-03-11T12:16:35.466444600Z . gen standil6 =1 if il6 ==1
2021-03-11T12:16:35.466446600Z (37,192 missing values generated)
2021-03-11T12:16:35.466448700Z 
2021-03-11T12:16:35.466450600Z . replace standil6 =0 if standsys ==1 & il6 !=1
2021-03-11T12:16:35.466452700Z (24,568 real changes made)
2021-03-11T12:16:35.466454700Z 
2021-03-11T12:16:35.466456700Z . 
2021-03-11T12:16:35.466458600Z . gen standil63m =1 if sarilumab_3m_0m ==1 | tocilizumab_3m_0m ==1
2021-03-11T12:16:35.466460800Z (31,849 missing values generated)
2021-03-11T12:16:35.466462800Z 
2021-03-11T12:16:35.466466800Z . replace standil63m =0 if sarilumab_3m_0m !=1 & tocilizumab_3m_0m !=1 & stands
2021-03-11T12:16:35.466469200Z > ys3m ==1
2021-03-11T12:16:35.466471200Z (14,729 real changes made)
2021-03-11T12:16:35.466473200Z 
2021-03-11T12:16:35.466475100Z . 
2021-03-11T12:16:35.466477100Z . gen il17 =1 if secukinumab_3m_0m !=0 | secukinumab_6m_3m !=0 | ixekizumab_3m_
2021-03-11T12:16:35.466479200Z > 0m !=0 | ixekizumab_6m_3m !=0 | brodalumab_3m_0m !=0 | brodalumab_6m_3m !=0 
2021-03-11T12:16:35.466481400Z (20,957 missing values generated)
2021-03-11T12:16:35.466483400Z 
2021-03-11T12:16:35.466485300Z . replace il17 =. if psoriatic_arthritis !=1 & ankylosing_spondylitis !=1 & pso
2021-03-11T12:16:35.466487900Z > riasis !=1
2021-03-11T12:16:35.466490000Z (10,200 real changes made, 10,200 to missing)
2021-03-11T12:16:35.466492100Z 
2021-03-11T12:16:35.466494000Z . 
2021-03-11T12:16:35.466496000Z . gen standil17 =1 if il17 ==1
2021-03-11T12:16:35.466498100Z (31,157 missing values generated)
2021-03-11T12:16:35.466500100Z 
2021-03-11T12:16:35.466502000Z . replace standil17 =0 if standsys ==1 & il17 !=1
2021-03-11T12:16:35.466504100Z (19,734 real changes made)
2021-03-11T12:16:35.466506100Z 
2021-03-11T12:16:35.466508000Z . 
2021-03-11T12:16:35.466510000Z . gen standil173m =1 if secukinumab_3m_0m ==1 | ixekizumab_3m_0m ==1 | brodalum
2021-03-11T12:16:35.466512100Z > ab_3m_0m ==1 
2021-03-11T12:16:35.466514100Z (28,644 missing values generated)
2021-03-11T12:16:35.466516100Z 
2021-03-11T12:16:35.466518100Z . replace standil173m =0 if secukinumab_3m_0m !=1 & ixekizumab_3m_0m !=1 & brod
2021-03-11T12:16:35.466520200Z > alumab_3m_0m !=1 & standsys3m ==1
2021-03-11T12:16:35.466522400Z (13,212 real changes made)
2021-03-11T12:16:35.466524300Z 
2021-03-11T12:16:35.466526300Z . 
2021-03-11T12:16:35.466528400Z . gen mesalazine =1 if mesalazine_3m_0m >=1 | mesalazine_6m_3m >=1
2021-03-11T12:16:35.466530500Z (33,107 missing values generated)
2021-03-11T12:16:35.466532600Z 
2021-03-11T12:16:35.466534800Z . replace mesalazine =. if imid !=1
2021-03-11T12:16:35.466536900Z (1,061 real changes made, 1,061 to missing)
2021-03-11T12:16:35.466538900Z 
2021-03-11T12:16:35.466540800Z . 
2021-03-11T12:16:35.466542700Z . gen standmesalazine =1 if mesalazine >=1
2021-03-11T12:16:35.466544800Z 
2021-03-11T12:16:35.466546700Z . replace standmesalazine =0 if standsys ==1 & mesalazine ==0
2021-03-11T12:16:35.466548800Z (0 real changes made)
2021-03-11T12:16:35.466550900Z 
2021-03-11T12:16:35.466555100Z . 
2021-03-11T12:16:35.466557300Z . gen standmesalazine3m =1 if mesalazine_3m_0m >=1
2021-03-11T12:16:35.466559500Z (36,083 missing values generated)
2021-03-11T12:16:35.466561500Z 
2021-03-11T12:16:35.466577500Z . replace standmesalazine3m =0 if mesalazine_3m_0m ==0 & standsys3m ==1
2021-03-11T12:16:35.466583400Z (15,422 real changes made)
2021-03-11T12:16:35.466586100Z 
2021-03-11T12:16:35.466588300Z . 
2021-03-11T12:16:35.466590300Z . gen steroidcat = 0
2021-03-11T12:16:35.466592300Z 
2021-03-11T12:16:35.466594200Z . replace steroidcat =1 if oral_prednisolone_3m_0m >=1 & oral_prednisolone_3m_0
2021-03-11T12:16:35.466596400Z > m!=.
2021-03-11T12:16:35.466598400Z (3,319 real changes made)
2021-03-11T12:16:35.466600400Z 
2021-03-11T12:16:35.466602300Z . 
2021-03-11T12:16:35.466604200Z . *gen imiddrugcategory = (standard v highcost)
2021-03-11T12:16:35.466606300Z . gen imiddrugcategory = 1 if standtnf ==1 | standil23 ==1 | standjaki ==1 | st
2021-03-11T12:16:35.466608400Z > andritux ==1 | standil6 ==1 | standil17 ==1
2021-03-11T12:16:35.466610500Z (8,684 missing values generated)
2021-03-11T12:16:35.466612500Z 
2021-03-11T12:16:35.466614400Z . recode imiddrugcategory .=0 if standsys ==1 
2021-03-11T12:16:35.466616500Z (imiddrugcategory: 1671 changes made)
2021-03-11T12:16:35.466618500Z 
2021-03-11T12:16:35.466620400Z . 
2021-03-11T12:16:35.466622300Z . 
2021-03-11T12:16:35.466624400Z . /* OUTCOME AND SURVIVAL TIME=================================================
2021-03-11T12:16:35.466626600Z > =*/
2021-03-11T12:16:35.466628500Z . /*  Cohort entry and censor dates  */
2021-03-11T12:16:35.466630500Z . 
2021-03-11T12:16:35.466632500Z . * Date of cohort entry, 1 Mar 2020
2021-03-11T12:16:35.466634500Z . gen enter_date = date("$indexdate", "DMY")
2021-03-11T12:16:35.466636700Z 
2021-03-11T12:16:35.466638600Z . format enter_date %td
2021-03-11T12:16:35.466640500Z 
2021-03-11T12:16:35.466642500Z . 
2021-03-11T12:16:35.466644400Z . /*   Outcomes   */
2021-03-11T12:16:35.466646300Z . 
2021-03-11T12:16:35.466648300Z . * Outcomes: itu admission, ONS-covid death  
2021-03-11T12:16:35.466651000Z . 
2021-03-11T12:16:35.466652900Z . * Add half-day buffer if outcome on indexdate
2021-03-11T12:16:35.466655000Z . replace died_ons_date=died_ons_date+0.5 if died_ons_date==enter_date
2021-03-11T12:16:35.466657100Z (0 real changes made)
2021-03-11T12:16:35.466659000Z 
2021-03-11T12:16:35.466664400Z . replace icu_admitted_date=icu_admitted_date+0.5 if icu_admitted_date==enter_d
2021-03-11T12:16:35.466666600Z > ate
2021-03-11T12:16:35.466668600Z (0 real changes made)
2021-03-11T12:16:35.466670600Z 
2021-03-11T12:16:35.466672500Z . 
2021-03-11T12:16:35.466674500Z . * Date of Covid death in ONS
2021-03-11T12:16:35.466676500Z . gen died_ons_date_covid = died_ons_date if died_ons_covid_flag_any == 1
2021-03-11T12:16:35.466678600Z (38,980 missing values generated)
2021-03-11T12:16:35.466680600Z 
2021-03-11T12:16:35.466682600Z . 
2021-03-11T12:16:35.466684500Z . * Date of non-COVID death in ONS 
2021-03-11T12:16:35.466686600Z . * If missing date of death resulting died_date will also be missing
2021-03-11T12:16:35.466688700Z . gen died_ons_date_noncovid = died_ons_date if died_ons_covid_flag_any != 1 
2021-03-11T12:16:35.466690900Z (35,728 missing values generated)
2021-03-11T12:16:35.466692900Z 
2021-03-11T12:16:35.466694900Z . 
2021-03-11T12:16:35.466697200Z . *date of COVID ITU admission ** issue we have is how we define an ITU admissi
2021-03-11T12:16:35.466699300Z > on as a COVID one. 
2021-03-11T12:16:35.466701300Z . gen icu_admit_diff = icu_admitted_date - first_pos_test_sgss_date
2021-03-11T12:16:35.466703400Z (38,940 missing values generated)
2021-03-11T12:16:35.466705400Z 
2021-03-11T12:16:35.466707400Z . replace icu_admit_diff =. if icu_admit_diff <-5
2021-03-11T12:16:35.466709600Z (178 real changes made, 178 to missing)
2021-03-11T12:16:35.466711800Z 
2021-03-11T12:16:35.466714600Z . gen icu_admit_date_covid = icu_admitted_date if icu_admit_diff <28 
2021-03-11T12:16:35.466716900Z (39,313 missing values generated)
2021-03-11T12:16:35.466719300Z 
2021-03-11T12:16:35.466721300Z . 
2021-03-11T12:16:35.466723700Z . gen icu_or_death_covid_date = icu_admit_date_covid
2021-03-11T12:16:35.466725800Z (39,313 missing values generated)
2021-03-11T12:16:35.466728100Z 
2021-03-11T12:16:35.466730100Z . replace icu_or_death_covid_date = died_ons_date_covid if icu_admit_date_covid
2021-03-11T12:16:35.466732200Z >  ==.
2021-03-11T12:16:35.466734200Z (364 real changes made)
2021-03-11T12:16:35.466736300Z 
2021-03-11T12:16:35.466738300Z . gen icu_or_death_covid =1 if icu_or_death_covid_date !=.
2021-03-11T12:16:35.466740400Z (38,949 missing values generated)
2021-03-11T12:16:35.466742400Z 
2021-03-11T12:16:35.466744400Z . 
2021-03-11T12:16:35.466746400Z . format died_ons_date_covid died_ons_date_noncovid icu_admit_date_covid icu_or
2021-03-11T12:16:35.466748600Z > _death_covid_date %td
2021-03-11T12:16:35.466753200Z 
2021-03-11T12:16:35.466755300Z . 
2021-03-11T12:16:35.466757200Z . 
2021-03-11T12:16:35.466759200Z . /* CENSORING */
2021-03-11T12:16:35.466761200Z . /* SET FU DATES==============================================================
2021-03-11T12:16:35.466763300Z > =*/ 
2021-03-11T12:16:35.466765300Z . * Censoring dates for each outcome (largely, last date outcome data available
2021-03-11T12:16:35.466767400Z > , minus a lag window based on previous graphs)
2021-03-11T12:16:35.466769700Z . *death
2021-03-11T12:16:35.466771800Z . tw histogram died_ons_date, discrete width(2) frequency ytitle(Number of ONS 
2021-03-11T12:16:35.466773900Z > deaths) xtitle(Date) scheme(meta) saving(out_death_freq, replace)
2021-03-11T12:16:35.466776000Z (note: file out_death_freq.gph not found)
2021-03-11T12:16:35.466778200Z (file out_death_freq.gph saved)
2021-03-11T12:16:35.466780300Z 
2021-03-11T12:16:35.466782300Z . graph export "output/figures/out_death_freq.svg", as(svg) replace
2021-03-11T12:16:35.466784500Z (note: file output/figures/out_death_freq.svg not found)
2021-03-11T12:16:35.466786600Z (file output/figures/out_death_freq.svg written in SVG format)
2021-03-11T12:16:35.466788800Z 
2021-03-11T12:16:35.466790800Z . graph close
2021-03-11T12:16:35.466792800Z 
2021-03-11T12:16:35.466794700Z . erase out_death_freq.svg
2021-03-11T12:16:35.466796700Z file out_death_freq.svg not found
2021-03-11T12:16:35.466798700Z r(601);
2021-03-11T12:16:35.466800800Z 
2021-03-11T12:16:35.466802800Z end of do-file
2021-03-11T12:16:35.466804800Z r(601);
2021-03-11T12:16:35.466823000Z 


state: failed
commit: none
docker_image_id: sha256:5a4bb3ecd807de29a18a01ffae01739415778f0b770cbd43d7140bb0017306f1
job_id: ktrmmoqx27azqqpw
run_by_user: arowan
created_at: 2021-03-11T12:16:20Z
started_at: 2021-03-11T12:16:30Z
completed_at: 2021-03-11T12:16:37Z

Job exited with an error code

outputs:
  logs/cr_create_analysis_dataset.smcl  - moderately_sensitive
  output/figures/out_death_freq.svg     - moderately_sensitive